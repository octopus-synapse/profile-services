bun test v1.2.23 (cf136713)

src/app.controller.spec.ts:
(pass) AppController > root > should return "Hello World!" [10.61ms]
(pass) AppController > health > should return health status [1.77ms]
(pass) AppController > version > should return version information [1.45ms]
(pass) AppController > version > should use development environment when manifest not available [1.00ms]

src/resumes/resumes.service.spec.ts:
(pass) ResumesService > Resume Limit (Maximum 4) > should allow creating resume when under limit [1.43ms]
(pass) ResumesService > Resume Limit (Maximum 4) > should reject creating 5th resume with error [1.06ms]
(pass) ResumesService > Resume Limit (Maximum 4) > should show clear error message about 4 resume limit [0.75ms]
(pass) ResumesService > Resume Limit (Maximum 4) > should allow creating exactly 4 resumes [0.69ms]
(pass) ResumesService > Resume CRUD Operations > should return all resumes for a user [0.80ms]
(pass) ResumesService > Resume CRUD Operations > should return resume by id if owned by user [0.90ms]
(pass) ResumesService > Resume CRUD Operations > should throw NotFoundException for non-existent resume [1.35ms]
(pass) ResumesService > Resume CRUD Operations > should update resume if owned by user [1.20ms]
(pass) ResumesService > Resume CRUD Operations > should delete resume if owned by user [1.00ms]
(pass) ResumesService > Remaining Slots > should correctly calculate remaining slots [0.84ms]
(pass) ResumesService > Remaining Slots > should show 0 remaining when at limit [0.75ms]
(pass) Experience Order Uniqueness > should reject creating experience with duplicate order [0.12ms]
(pass) Experience Order Uniqueness > should allow creating experience with unique order [0.05ms]
(pass) Experience Order Uniqueness > should auto-assign next order when not specified [0.07ms]
(pass) isCurrent and endDate Validation > should accept isCurrent=true with endDate=null [0.05ms]
(pass) isCurrent and endDate Validation > should reject isCurrent=true with non-null endDate [0.03ms]
(pass) isCurrent and endDate Validation > should accept isCurrent=false with endDate set [0.02ms]
(pass) isCurrent and endDate Validation > should accept isCurrent=false with endDate=null (left position) [0.01ms]
(pass) Skills Reference Validation > should accept valid skill references [0.13ms]
(pass) Skills Reference Validation > should reject invalid skill references [0.08ms]
(pass) Skills Reference Validation > should accept empty skill references [0.02ms]

src/resumes/resumes.service.bug-detection.spec.ts:
(pass) ResumesService - Bug Detection > BUG #3: Resume limit should return HTTP 422 > should throw UnprocessableEntityException (422) when limit reached [1.01ms]
(pass) ResumesService - Bug Detection > BUG #3: Resume limit should return HTTP 422 > should NOT throw BadRequestException (400) for limit error [0.83ms]
(pass) ResumesService - Bug Detection > BUG #3: Resume limit should return HTTP 422 > should have exactly the message "O limite mÃ¡ximo de currÃ­culos Ã© 4" (pt-BR) [0.98ms]
(pass) ResumesService - Bug Detection > Resume limit boundary tests > should allow creating 4th resume (at limit) [0.60ms]
(pass) ResumesService - Bug Detection > Resume limit boundary tests > should reject at exactly 4 existing resumes [0.47ms]

src/resumes/resumes.repository.spec.ts:
(pass) ResumesRepository > findAll > should return empty array when user has no resumes [3.00ms]
(pass) ResumesRepository > findAll > should return all resumes for the user [1.67ms]
(pass) ResumesRepository > findOne > should return resume when it exists and belongs to user [1.33ms]
(pass) ResumesRepository > findOne > should return null when resume does not exist [1.36ms]
(pass) ResumesRepository > findOne > should return null when resume belongs to another user [1.08ms]
(pass) ResumesRepository > create > should create resume and return it with generated id [0.97ms]
(pass) ResumesRepository > create > should persist resume to storage [0.79ms]
(pass) ResumesRepository > update > should update resume when user owns it [0.85ms]
(pass) ResumesRepository > update > should throw ForbiddenException when resume does not exist [0.80ms]
(pass) ResumesRepository > update > should throw ForbiddenException when user does not own resume [0.75ms]
(pass) ResumesRepository > delete > should delete resume and return true when user owns it [0.79ms]
(pass) ResumesRepository > delete > should throw ForbiddenException when resume does not exist [0.78ms]
(pass) ResumesRepository > delete > should throw ForbiddenException when user does not own resume [0.78ms]
(pass) ResumesRepository > findByUserId > should return null when user has no resume [1.10ms]
(pass) ResumesRepository > findByUserId > should return first resume for user [1.33ms]

src/users/users.service.spec.ts:
(pass) UsersService (Facade) > getPublicProfileByUsername > should return public profile with user and resume data [2.12ms]
(pass) UsersService (Facade) > getProfile > should return user profile with expected fields [0.92ms]
(pass) UsersService (Facade) > updateProfile > should return success with updated profile data [0.72ms]
(pass) UsersService (Facade) > getPreferences > should return user preferences [0.65ms]
(pass) UsersService (Facade) > updatePreferences > should return success when preferences are updated [0.81ms]
(pass) UsersService (Facade) > getFullPreferences > should return complete preferences object [0.72ms]
(pass) UsersService (Facade) > updateFullPreferences > should return success when full preferences are updated [0.58ms]
(pass) UsersService (Facade) > updateUsername > should return success with new username [0.62ms]
(pass) UsersService (Facade) > checkUsernameAvailability > should return availability status [0.56ms]

src/upload/upload.service.security.spec.ts:
(pass) UploadService - SECURITY BUG DETECTION > BUG-024: SVG XSS Prevention > should REJECT SVG files with embedded scripts [1.12ms]
(pass) UploadService - SECURITY BUG DETECTION > BUG-024: SVG XSS Prevention > should REJECT SVG with event handlers [0.83ms]
(pass) UploadService - SECURITY BUG DETECTION > BUG-025: Magic Bytes Validation > should REJECT file with spoofed MIME type [1.11ms]
(pass) UploadService - SECURITY BUG DETECTION > BUG-025: Magic Bytes Validation > should validate JPEG magic bytes (FFD8FF) [1.08ms]
(pass) UploadService - SECURITY BUG DETECTION > BUG-025: Magic Bytes Validation > should validate PNG magic bytes (89504E47) [0.82ms]
(pass) UploadService - SECURITY BUG DETECTION > BUG-026: Extension Sanitization > should REJECT double extension attack (image.jpg.php) [0.79ms]
(pass) UploadService - SECURITY BUG DETECTION > BUG-026: Extension Sanitization > should REJECT null byte attack (image.php%00.jpg) [1.21ms]
(pass) UploadService - SECURITY BUG DETECTION > BUG-026: Extension Sanitization > should REJECT directory traversal in filename [0.95ms]
(pass) UploadService - SECURITY BUG DETECTION > BUG-027: File Ownership Validation > should REJECT deleting another users file [1.11ms]

src/onboarding/onboarding.service.spec.ts:
(pass) OnboardingService > completeOnboarding > should successfully complete onboarding [4.16ms]
(pass) OnboardingService > completeOnboarding > should throw NotFoundException if user does not exist [1.61ms]
(pass) OnboardingService > completeOnboarding > should throw error if data validation fails [1.62ms]
(pass) OnboardingService > getOnboardingStatus > should successfully get onboarding status [0.69ms]
(pass) OnboardingService > getOnboardingStatus > should return incomplete status for user who has not completed onboarding [0.52ms]
(pass) OnboardingService > getOnboardingStatus > should throw NotFoundException if user does not exist [0.56ms]

src/auth/auth.service.spec.ts:
(pass) AuthService (Facade) > signup > should return auth response with token and user on successful signup [1.64ms]
(pass) AuthService (Facade) > login > should return auth response with token on successful login [0.89ms]
(pass) AuthService (Facade) > validateUser > should return user without password when credentials are valid [0.94ms]
(pass) AuthService (Facade) > refreshToken > should return new token on successful refresh [0.56ms]
(pass) AuthService (Facade) > refreshTokenWithToken > should return new token when given valid refresh token [0.50ms]
(pass) AuthService (Facade) > getCurrentUser > should return current user data [0.44ms]
(pass) AuthService (Facade) > requestEmailVerification > should return success when verification email is sent [0.44ms]
(pass) AuthService (Facade) > verifyEmail > should return success when email is verified [0.42ms]
(pass) AuthService (Facade) > forgotPassword > should return success when reset email is sent [0.43ms]
(pass) AuthService (Facade) > resetPassword > should return success when password is reset [0.44ms]
(pass) AuthService (Facade) > changePassword > should return success when password is changed [0.43ms]
(pass) AuthService (Facade) > changeEmail > should return success when email is changed [0.43ms]
(pass) AuthService (Facade) > deleteAccount > should return success when account is deleted [0.44ms]

src/dsl/dsl.repository.spec.ts:
(pass) DslRepository > preview > should compile DSL for preview [0.95ms]
(pass) DslRepository > validate > should validate DSL [1.16ms]
(pass) DslRepository > render > should render resume AST [1.04ms]
(pass) DslRepository > render > should throw if resume not found [0.86ms]
(pass) DslRepository > renderPublic > should render public resume AST [0.67ms]
(pass) DslRepository > renderPublic > should throw if public resume not found [0.50ms]
(pass) DslRepository > mergeDsl > should deep merge DSL objects [0.44ms]

src/health/health.controller.spec.ts:
(pass) HealthController > check (all services) > should check all health indicators [0.86ms]
(pass) HealthController > check (all services) > should invoke all health indicators when called [0.54ms]
(pass) HealthController > checkDatabase > should check only database health [0.42ms]
(pass) HealthController > checkDatabase > should invoke database health indicator when called [0.45ms]
(pass) HealthController > checkRedis > should check only redis health [0.41ms]
(pass) HealthController > checkRedis > should invoke redis health indicator when called [0.39ms]
(pass) HealthController > checkStorage > should check only storage health [0.40ms]
(pass) HealthController > checkStorage > should invoke storage health indicator when called [0.72ms]
(pass) HealthController > checkTranslate > should check only translate service health [0.87ms]
(pass) HealthController > checkTranslate > should invoke translate health indicator when called [0.72ms]
(pass) HealthController > error handling > should handle health check failures for all services [0.46ms]
(pass) HealthController > error handling > should handle database health check failure [0.39ms]

src/translation/translation.service.spec.ts:
(pass) TranslationService > onModuleInit > should check service health on initialization [0.77ms]
(pass) TranslationService > checkServiceHealth > should delegate health check to core service [0.40ms]
(pass) TranslationService > checkServiceHealth > should return false when service is unavailable [0.32ms]
(pass) TranslationService > translatePtToEn > should translate Portuguese text to English [0.33ms]
(pass) TranslationService > translateEnToPt > should translate English text to Portuguese [0.33ms]
(pass) TranslationService > translate > should translate text with Portuguese to English [0.32ms]
(pass) TranslationService > translate > should handle English to Portuguese translation [0.34ms]
(pass) TranslationService > translateBatch > should translate multiple texts at once [0.35ms]
(pass) TranslationService > translateBatch > should handle empty batch gracefully [0.33ms]
(pass) TranslationService > translateResumeToEnglish > should translate resume data to English [0.52ms]
(pass) TranslationService > translateResumeToEnglish > should handle complex resume structure [0.49ms]
(pass) TranslationService > translateResumeToPortuguese > should translate resume data to Portuguese [0.46ms]
(pass) TranslationService > isAvailable > should return true when service is available [0.30ms]
(pass) TranslationService > isAvailable > should return false when service is unavailable [0.27ms]
(pass) TranslationService > service availability delegation > should consistently reflect core service availability state [0.26ms]

src/common/email/email.service.spec.ts:
(pass) EmailService (Adapter) > sendEmail > should complete successfully when sending raw email [0.72ms]
(pass) EmailService (Adapter) > sendEmail > should propagate error when sending fails [0.44ms]
(pass) EmailService (Adapter) > sendVerificationEmail > should complete successfully when sending verification email [0.33ms]
(pass) EmailService (Adapter) > sendVerificationEmail > should propagate error when sending fails [0.29ms]
(pass) EmailService (Adapter) > sendPasswordResetEmail > should complete successfully when sending password reset email [0.30ms]
(pass) EmailService (Adapter) > sendPasswordResetEmail > should propagate error when sending fails [0.32ms]
(pass) EmailService (Adapter) > sendWelcomeEmail > should complete successfully when sending welcome email [0.30ms]
(pass) EmailService (Adapter) > sendWelcomeEmail > should propagate error when sending fails [0.28ms]
(pass) EmailService (Adapter) > sendPasswordChangedEmail > should complete successfully when sending password changed email [0.44ms]
(pass) EmailService (Adapter) > sendPasswordChangedEmail > should propagate error when sending fails [0.76ms]

src/common/audit/audit-log.service.spec.ts:
(pass) AuditLogService > log > should create audit log entry [1.05ms]
(pass) AuditLogService > log > should extract request metadata when provided [0.46ms]
(pass) AuditLogService > log > should not throw on prisma errors [0.40ms]
(pass) AuditLogService > logUsernameChange > should log username change with before/after [0.39ms]
(pass) AuditLogService > logResumeDeletion > should log resume deletion with data snapshot [0.36ms]
(pass) AuditLogService > logVisibilityChange > should log visibility change [0.35ms]
(pass) AuditLogService > logUnauthorizedAccess > should log unauthorized access attempt [0.31ms]
(pass) AuditLogService > getUserLogs > should return logs for specific user [0.41ms]
(pass) AuditLogService > cleanupOldLogs > should delete old logs and return count [0.37ms]

src/common/cache/cache.service.spec.ts:
(pass) CacheService (Adapter) > when Redis is enabled > should report enabled status [0.69ms]
(pass) CacheService (Adapter) > when Redis is enabled > get/set operations > should return null for non-existent key [0.35ms]
(pass) CacheService (Adapter) > when Redis is enabled > get/set operations > should return stored value after set [0.33ms]
(pass) CacheService (Adapter) > when Redis is enabled > get/set operations > should return null after delete [0.36ms]
(pass) CacheService (Adapter) > when Redis is enabled > deletePattern > should delete all keys matching pattern [0.40ms]
(pass) CacheService (Adapter) > when Redis is enabled > flush > should clear all cached data [0.35ms]
(pass) CacheService (Adapter) > when Redis is enabled > lock operations > should acquire lock when not locked [0.31ms]
(pass) CacheService (Adapter) > when Redis is enabled > lock operations > should fail to acquire lock when already locked [0.28ms]
(pass) CacheService (Adapter) > when Redis is enabled > lock operations > should allow acquire after release [0.33ms]
(pass) CacheService (Adapter) > when Redis is enabled > lock operations > should report correct lock status [0.33ms]
(pass) CacheService (Adapter) > when Redis is enabled > getOrSet (cache-aside pattern) > should compute and cache value on cache miss [0.37ms]
(pass) CacheService (Adapter) > when Redis is enabled > getOrSet (cache-aside pattern) > should return cached value without computing on cache hit [0.33ms]
(pass) CacheService (Adapter) > when Redis is enabled > onModuleDestroy > should complete cleanup without error [0.30ms]
(pass) CacheService (Adapter) > when Redis is disabled > should report disabled status [0.59ms]
(pass) CacheService (Adapter) > when Redis is disabled > should return null for get operations [0.50ms]

src/common/logger/logger.service.spec.ts:
(pass) AppLoggerService > log > should log info message without throwing [4.67ms]
(pass) AppLoggerService > log > should log with context [0.32ms]
(pass) AppLoggerService > log > should log with metadata [0.21ms]
2026-01-07 19:23:24 [Application] [31merror[39m: Error message
(pass) AppLoggerService > error > should log error message without throwing [0.37ms]
2026-01-07 19:23:24 [ErrorContext] [31merror[39m: Error message
Stack trace here
(pass) AppLoggerService > error > should log error with stack trace [0.23ms]
2026-01-07 19:23:24 [Context] [31merror[39m: Error message {"code":"E001"}
Stack
(pass) AppLoggerService > error > should log error with metadata [0.20ms]
(pass) AppLoggerService > warn > should log warning message without throwing [0.22ms]
(pass) AppLoggerService > warn > should log warning with context and metadata [0.17ms]
(pass) AppLoggerService > debug > should log debug message without throwing [0.17ms]
(pass) AppLoggerService > debug > should log debug with context and metadata [0.19ms]
(pass) AppLoggerService > verbose > should log verbose message without throwing [0.20ms]
(pass) AppLoggerService > verbose > should use default context when set [0.18ms]
(pass) AppLoggerService > setContext > should set context for subsequent logs [0.19ms]
2026-01-07 19:23:24 [ErrorService] [31merror[39m: Error occurred {"errorCode":"E500"}
(pass) AppLoggerService > errorWithMeta > should log error with metadata using default context [0.23ms]

src/common/guards/roles.guard.spec.ts:
(pass) RolesGuard > canActivate > should allow access when no roles are required [0.69ms]
(pass) RolesGuard > canActivate > should allow access when user has required role [0.33ms]
(pass) RolesGuard > canActivate > should deny access when user does not have required role [0.23ms]
(pass) RolesGuard > canActivate > should deny access when user is not authenticated [0.22ms]
(pass) RolesGuard > canActivate > should allow access when user has one of multiple allowed roles [0.21ms]
(pass) RolesGuard > canActivate > should deny access when user role is not in allowed roles list [0.22ms]
(pass) RolesGuard > canActivate > should check roles from handler metadata [0.27ms]
(pass) RolesGuard > canActivate > should allow any authenticated user when roles array is empty [0.22ms]
(pass) RolesGuard > canActivate > should handle null user in request [0.24ms]
(pass) RolesGuard > role hierarchy > should not implicitly grant higher privileges to admins [0.20ms]
(pass) RolesGuard > role hierarchy > should require exact role match [0.18ms]

src/resumes/services/project.service.spec.ts:
(pass) ProjectService > listForResume > should return paginated projects for resume [1.02ms]
(pass) ProjectService > getById > should return single project [0.41ms]
(pass) ProjectService > getById > should throw NotFoundException when project not found [0.33ms]
(pass) ProjectService > addToResume > should create new project [0.33ms]
(pass) ProjectService > updateById > should update existing project [0.35ms]
(pass) ProjectService > updateById > should throw NotFoundException when project not found [0.31ms]
(pass) ProjectService > deleteById > should delete project successfully [0.31ms]
(pass) ProjectService > deleteById > should throw NotFoundException when project not found [0.26ms]

src/resumes/services/bug-bounty.service.spec.ts:
(pass) BugBountyService > should be defined [0.53ms]
(pass) BugBountyService > should have correct entity name [0.25ms]
(pass) BugBountyService > should have a logger instance [0.22ms]
(pass) BugBountyService > CRUD operations > should list bug bounties for resume [0.29ms]
(pass) BugBountyService > CRUD operations > should add bug bounty to resume [0.31ms]
(pass) BugBountyService > CRUD operations > should delete bug bounty [0.26ms]

src/resumes/services/certification.service.spec.ts:
(pass) CertificationService > should be defined [0.60ms]
(pass) CertificationService > should have correct entity name [0.28ms]
(pass) CertificationService > should have a logger instance [0.25ms]
(pass) CertificationService > CRUD operations (inherited from BaseSubResourceService) > should list certifications for resume [0.30ms]
(pass) CertificationService > CRUD operations (inherited from BaseSubResourceService) > should get certification by id [0.32ms]
(pass) CertificationService > CRUD operations (inherited from BaseSubResourceService) > should add certification to resume [0.37ms]
(pass) CertificationService > CRUD operations (inherited from BaseSubResourceService) > should update certification [0.34ms]
(pass) CertificationService > CRUD operations (inherited from BaseSubResourceService) > should delete certification [0.29ms]

src/resumes/services/talk.service.spec.ts:
(pass) TalkService > should be defined [0.74ms]
(pass) TalkService > should have correct entity name [0.27ms]
(pass) TalkService > should have a logger instance [0.21ms]
(pass) TalkService > CRUD operations > should list talks for resume [0.28ms]
(pass) TalkService > CRUD operations > should add talk to resume [0.27ms]
(pass) TalkService > CRUD operations > should delete talk [0.26ms]

src/resumes/services/language.service.spec.ts:
(pass) LanguageService > should be defined [0.50ms]
(pass) LanguageService > should have correct entity name [0.25ms]
(pass) LanguageService > should have a logger instance [0.23ms]
(pass) LanguageService > CRUD operations (inherited from BaseSubResourceService) > should list languages for resume [0.31ms]
(pass) LanguageService > CRUD operations (inherited from BaseSubResourceService) > should add language to resume [0.30ms]
(pass) LanguageService > CRUD operations (inherited from BaseSubResourceService) > should delete language [0.27ms]

src/resumes/services/hackathon.service.spec.ts:
(pass) HackathonService > should be defined [0.52ms]
(pass) HackathonService > should have correct entity name [0.26ms]
(pass) HackathonService > should have a logger instance [0.29ms]
(pass) HackathonService > CRUD operations > should list hackathons for resume [0.30ms]
(pass) HackathonService > CRUD operations > should add hackathon to resume [0.28ms]
(pass) HackathonService > CRUD operations > should delete hackathon [0.26ms]

src/resumes/services/recommendation.service.spec.ts:
(pass) RecommendationService > should be defined [0.59ms]
(pass) RecommendationService > should have correct entity name [0.26ms]
(pass) RecommendationService > should have a logger instance [0.23ms]
(pass) RecommendationService > CRUD operations > should list recommendations for resume [0.34ms]
(pass) RecommendationService > CRUD operations > should add recommendation to resume [0.34ms]
(pass) RecommendationService > CRUD operations > should delete recommendation [0.30ms]

src/resumes/services/education.service.spec.ts:
(pass) EducationService > listForResume > should return paginated education entries [0.82ms]
(pass) EducationService > getById > should return single education entry [0.32ms]
(pass) EducationService > getById > should throw NotFoundException when not found [0.31ms]
(pass) EducationService > addToResume > should create new education entry [0.35ms]
(pass) EducationService > updateById > should update existing education entry [0.43ms]
(pass) EducationService > deleteById > should delete education entry successfully [0.30ms]
(pass) EducationService > reorder > should reorder education entries with custom message [0.30ms]

src/resumes/services/experience.service.spec.ts:
(pass) ExperienceService > listForResume > should return paginated experiences [0.61ms]
(pass) ExperienceService > getById > should return single experience [0.29ms]
(pass) ExperienceService > getById > should throw NotFoundException when not found [0.28ms]
(pass) ExperienceService > addToResume > should create new experience [0.37ms]
(pass) ExperienceService > updateById > should update existing experience [0.37ms]
(pass) ExperienceService > updateById > should throw NotFoundException when not found [0.30ms]
(pass) ExperienceService > deleteById > should delete experience successfully [0.26ms]
(pass) ExperienceService > deleteById > should throw NotFoundException when not found [0.24ms]

src/resumes/services/interest.service.spec.ts:
(pass) InterestService > should be defined [0.48ms]
(pass) InterestService > should have correct entity name [0.22ms]
(pass) InterestService > should have a logger instance [0.21ms]
(pass) InterestService > CRUD operations > should list interests for resume [0.31ms]
(pass) InterestService > CRUD operations > should add interest to resume [0.28ms]
(pass) InterestService > CRUD operations > should delete interest [0.26ms]

src/resumes/services/publication.service.spec.ts:
(pass) PublicationService > listForResume > should return paginated publications [0.96ms]
(pass) PublicationService > getById > should return single publication [0.49ms]
(pass) PublicationService > getById > should throw NotFoundException when not found [0.34ms]
(pass) PublicationService > addToResume > should create new publication [0.33ms]
(pass) PublicationService > updateById > should update existing publication [0.33ms]
(pass) PublicationService > deleteById > should delete publication successfully [0.27ms]

src/resumes/services/open-source.service.spec.ts:
(pass) OpenSourceService > should be defined [0.46ms]
(pass) OpenSourceService > should have correct entity name [0.22ms]
(pass) OpenSourceService > should have a logger instance [0.28ms]
(pass) OpenSourceService > CRUD operations > should list open source contributions for resume [0.29ms]
(pass) OpenSourceService > CRUD operations > should add open source contribution to resume [0.30ms]
(pass) OpenSourceService > CRUD operations > should delete open source contribution [0.27ms]

src/resumes/services/limits.bug.spec.ts:
(pass) Resource Limits - BUG DETECTION > BUG-061: No Skills Limit > should limit skills per resume [1.47ms]
(pass) Resource Limits - BUG DETECTION > BUG-062: No Experiences Limit > should limit experiences per resume [0.32ms]
(pass) Resource Limits - BUG DETECTION > Other Missing Limits > should limit education entries
(pass) Resource Limits - BUG DETECTION > Other Missing Limits > should limit projects
(pass) Resource Limits - BUG DETECTION > Other Missing Limits > should limit certifications
(pass) Resource Limits - BUG DETECTION > Other Missing Limits > should limit total resume size

src/export/services/resume-docx.service.spec.ts:
(pass) ResumeDOCXService > generate > should generate DOCX for complete resume [1.31ms]
(pass) ResumeDOCXService > generate > should throw NotFoundException when user not found [1.22ms]
(pass) ResumeDOCXService > generate > should throw NotFoundException when resume not found [0.89ms]
(pass) ResumeDOCXService > generate > should handle errors from builder service [0.85ms]

src/export/services/resume-pdf.service.spec.ts:
(pass) ResumePDFService > generate > should generate PDF for valid resume with default options [0.68ms]
(pass) ResumePDFService > generate > should use custom palette parameter [0.35ms]
(pass) ResumePDFService > generate > should use custom language parameter [0.29ms]
(pass) ResumePDFService > generate > should include bannerColor when provided [0.26ms]
(pass) ResumePDFService > generate > should include userId when provided [0.30ms]
(pass) ResumePDFService > generate > should pass through all options to generator [0.28ms]
(pass) ResumePDFService > generate > should handle errors from generator [0.31ms]

src/export/services/docx-builder.service.spec.ts:
(pass) DocxBuilderService > generate > should return DOCX buffer [22.58ms]
(pass) DocxBuilderService > generate > should throw NotFoundException when user not found [1.03ms]
(pass) DocxBuilderService > generate > should throw NotFoundException when resume not found [0.58ms]
(pass) DocxBuilderService > generate > should use sections service to create document structure [7.95ms]
(pass) DocxBuilderService > generate > should apply document styles [6.27ms]

src/export/services/browser-manager.service.spec.ts:
(pass) BrowserManagerService > getBrowser > should launch browser on first call [0.96ms]
(pass) BrowserManagerService > getBrowser > should reuse existing browser on subsequent calls [0.36ms]
(pass) BrowserManagerService > getBrowser > should handle browser launch failure [0.33ms]
(pass) BrowserManagerService > closeBrowser > should close browser and clear reference [0.35ms]
(pass) BrowserManagerService > closeBrowser > should do nothing if browser not initialized [0.28ms]
(pass) BrowserManagerService > closeBrowser > should allow launching new browser after close [0.27ms]
(pass) BrowserManagerService > isActive > should return false when browser not initialized [0.21ms]
(pass) BrowserManagerService > isActive > should return true when browser is active [0.24ms]
(pass) BrowserManagerService > isActive > should return false after browser is closed [0.23ms]
(pass) BrowserManagerService > concurrent access > should handle concurrent getBrowser calls safely [0.30ms]

src/export/services/banner-capture.service.spec.ts:
(pass) BannerCaptureService > capture > should capture banner screenshot with default parameters [1.29ms]
(pass) BannerCaptureService > capture > should capture banner screenshot with custom palette [0.40ms]
(pass) BannerCaptureService > capture > should include logo URL when provided [0.41ms]
(pass) BannerCaptureService > capture > should apply correct viewport dimensions [0.33ms]
(pass) BannerCaptureService > capture > should wait for code block rendering [0.33ms]
(pass) BannerCaptureService > capture > should apply quality styles (antialiasing) [0.33ms]
(pass) BannerCaptureService > capture > should close page on success [0.30ms]
[31m[Nest] 348886  - [39m01/07/2026, 7:23:24 PM [31m  ERROR[39m [38;5;3m[BannerCaptureService] [39m[31m[BannerCapture] #banner not found![39m
(pass) BannerCaptureService > error handling > should handle #banner not found [1.35ms]
[31m[Nest] 348886  - [39m01/07/2026, 7:23:24 PM [31m  ERROR[39m [38;5;3m[BannerPageSetup] [39m[31m[BannerCapture] Error during page.goto:[39m
[31m[Nest] 348886  - [39m01/07/2026, 7:23:24 PM [31m  ERROR[39m [38;5;3m[BannerPageSetup] [39mError: Navigation failed
    at <anonymous> [90m(/home/ilelo/Documents/Projects/profile/profile-services/[39msrc/export/services/banner-capture.service.spec.ts:178:47[90m)[39m
    at <anonymous> [90m(/home/ilelo/Documents/Projects/profile/profile-services/[39msrc/export/services/banner-capture.service.spec.ts:177:49[90m)[39m
(pass) BannerCaptureService > error handling > should close page on navigation error [2.56ms]
[31m[Nest] 348886  - [39m01/07/2026, 7:23:24 PM [31m  ERROR[39m [38;5;3m[BannerReadyWaiter] [39m[31m[BannerCapture] <body> HTML snippet:[39m
<div id="banner"></div>
(pass) BannerCaptureService > error handling > should close page on selector timeout [0.88ms]
(pass) BannerCaptureService > error handling > should handle broken logo image (404) [0.57ms]
[31m[Nest] 348886  - [39m01/07/2026, 7:23:24 PM [31m  ERROR[39m [38;5;3m[BannerPageSetup] [39m[31m[BannerCapture] Error during page.goto:[39m
[31m[Nest] 348886  - [39m01/07/2026, 7:23:24 PM [31m  ERROR[39m [38;5;3m[BannerPageSetup] [39mError: Navigation failed
    at <anonymous> [90m(/home/ilelo/Documents/Projects/profile/profile-services/[39msrc/export/services/banner-capture.service.spec.ts:218:47[90m)[39m
    at <anonymous> [90m(/home/ilelo/Documents/Projects/profile/profile-services/[39msrc/export/services/banner-capture.service.spec.ts:217:60[90m)[39m
(pass) BannerCaptureService > error handling > should take debug screenshot on navigation error [0.57ms]
[31m[Nest] 348886  - [39m01/07/2026, 7:23:24 PM [31m  ERROR[39m [38;5;3m[BannerReadyWaiter] [39m[31m[BannerCapture] <body> HTML snippet:[39m
<div id="banner"></div>
(pass) BannerCaptureService > error handling > should take debug screenshot on selector wait error [0.52ms]
(pass) BannerCaptureService > URL building > should use configured host and port [0.41ms]
(pass) BannerCaptureService > URL building > should use default host when not configured [0.50ms]
(pass) BannerCaptureService > URL building > should properly encode palette parameter [0.37ms]
(pass) BannerCaptureService > URL building > should properly encode logo URL parameter [0.42ms]
(pass) BannerCaptureService > banner element capture > should capture #banner element as PNG [0.39ms]
(pass) BannerCaptureService > banner element capture > should return buffer from element screenshot [0.42ms]
(pass) BannerCaptureService > wait for rendering > should wait for fonts to load [0.36ms]
(pass) BannerCaptureService > wait for rendering > should wait for #banner selector [0.37ms]
(pass) BannerCaptureService > wait for rendering > should wait for #company-logo when logo URL provided [0.35ms]
(pass) BannerCaptureService > wait for rendering > should not wait for logo when no logo URL provided [0.35ms]

src/export/services/pdf-generator.service.spec.ts:
(pass) PdfGeneratorService > generate > should return PDF buffer [1.10ms]
(pass) PdfGeneratorService > generate > should setup page before navigation [0.44ms]
(pass) PdfGeneratorService > generate > should wait for resume to be ready [0.34ms]
(pass) PdfGeneratorService > generate > should extract and apply styles [0.34ms]
(pass) PdfGeneratorService > generate > should close page after generation [0.36ms]
(pass) PdfGeneratorService > generate > should close page even on error [0.47ms]
(pass) PdfGeneratorService > generate > should pass options to URL builder [0.44ms]

src/export/services/pdf-generator.service.bug.spec.ts:
(pass) PdfGeneratorService - BUG DETECTION > BUG-037: No Timeout Protection > should have timeout on page operations [103.76ms]
(pass) PdfGeneratorService - BUG DETECTION > BUG-037: No Timeout Protection > should cleanup page even on timeout [0.89ms]
(pass) PdfGeneratorService - BUG DETECTION > BUG: Resource Exhaustion > should limit concurrent PDF generations [1.33ms]

src/admin/services/admin-stats.service.spec.ts:
(pass) AdminStatsService > getStats > should return correct statistics [1.39ms]
(pass) AdminStatsService > getStats > should filter admins correctly [0.71ms]

src/admin/services/user-admin-query.service.spec.ts:
(pass) UserAdminQueryService > getAll > should return paginated users list [1.25ms]
(pass) UserAdminQueryService > getAll > should filter by search term [0.64ms]
(pass) UserAdminQueryService > getAll > should filter by role [0.55ms]
(pass) UserAdminQueryService > getAll > should calculate correct pagination [0.94ms]
(pass) UserAdminQueryService > getById > should return user without password [1.03ms]
(pass) UserAdminQueryService > getById > should include resumes and preferences [0.41ms]
(pass) UserAdminQueryService > getById > should throw NotFoundException when user not found [2.91ms]

src/admin/services/csrf.bug.spec.ts:
(pass) CSRF Protection - BUG DETECTION > BUG-045: Missing CSRF Protection > should require CSRF token for DELETE user
(pass) CSRF Protection - BUG DETECTION > BUG-045: Missing CSRF Protection > should require CSRF token for password change
(pass) CSRF Protection - BUG DETECTION > BUG-045: Missing CSRF Protection > should require CSRF token for email change
(pass) CSRF Protection - BUG DETECTION > BUG-045: Missing CSRF Protection > should validate CSRF token origin
(pass) CSRF Protection - BUG DETECTION > BUG-045: Missing CSRF Protection > should use SameSite=Strict for session cookies

src/mec-sync/parsers/entity.normalizer.spec.ts:
(pass) Entity Normalizer > normalizeInstitution > Valid Input > should normalize a complete institution row [0.52ms]
(pass) Entity Normalizer > normalizeInstitution > Valid Input > should uppercase UF [0.13ms]
(pass) Entity Normalizer > normalizeInstitution > Valid Input > should handle missing optional fields [0.11ms]
(pass) Entity Normalizer > normalizeInstitution > Valid Input > should normalize text with extra whitespace [0.08ms]
(pass) Entity Normalizer > normalizeInstitution > Invalid Input > should return null when CO_IES is not a number [0.05ms]
(pass) Entity Normalizer > normalizeInstitution > Invalid Input > should return null when CO_IES is empty [0.04ms]
(pass) Entity Normalizer > normalizeInstitution > Invalid Input > should return null when NO_IES is empty [0.04ms]
(pass) Entity Normalizer > normalizeInstitution > Invalid Input > should return null when SG_UF_IES is empty [0.03ms]
(pass) Entity Normalizer > normalizeInstitution > Organization and Category Mapping > should map organization type [0.12ms]
(pass) Entity Normalizer > normalizeInstitution > Organization and Category Mapping > should map category type [0.12ms]
(pass) Entity Normalizer > normalizeCourse > Valid Input > should normalize a complete course row [0.32ms]
(pass) Entity Normalizer > normalizeCourse > Valid Input > should handle missing optional fields [0.12ms]
(pass) Entity Normalizer > normalizeCourse > Valid Input > should map degree type [0.09ms]
(pass) Entity Normalizer > normalizeCourse > Valid Input > should map modality type [0.08ms]
(pass) Entity Normalizer > normalizeCourse > Valid Input > should map course status [0.06ms]
(pass) Entity Normalizer > normalizeCourse > Invalid Input > should return null when CO_CURSO is not a number [0.04ms]
(pass) Entity Normalizer > normalizeCourse > Invalid Input > should return null when CO_CURSO is empty [0.04ms]
(pass) Entity Normalizer > normalizeCourse > Invalid Input > should return null when CO_IES is not a number [0.04ms]
(pass) Entity Normalizer > normalizeCourse > Invalid Input > should return null when NO_CURSO is empty [0.04ms]
(pass) Entity Normalizer > normalizeCourse > Edge Cases > should handle zero as valid course code [0.06ms]
(pass) Entity Normalizer > normalizeCourse > Edge Cases > should handle floating point numbers (truncates) [0.07ms]
(pass) Entity Normalizer > normalizeCourse > Edge Cases > should normalize course name with special characters [0.10ms]

src/mec-sync/parsers/mec-row.mapper.spec.ts:
(pass) MEC Row Mapper > mapToMecRow > Standard Column Names > should map values with standard MEC column names [0.29ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle CODIGO_IES as alternative to CO_IES [0.06ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle NOME_IES as alternative to NO_IES [0.05ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle ORGANIZACAO_ACADEMICA as alternative [0.05ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle TP_ORGANIZACAO_ACADEMICA as alternative [0.04ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle CATEGORIA_ADMINISTRATIVA as alternative [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle CODIGO_MUNICIPIO as alternative [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle MUNICIPIO as alternative to NO_MUNICIPIO_IES [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle UF as alternative to SG_UF_IES [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle CODIGO_CURSO as alternative to CO_CURSO [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle NOME_CURSO as alternative to NO_CURSO [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle GRAU as alternative to TP_GRAU [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle MODALIDADE as alternative to TP_MODALIDADE [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle AREA_OCDE_CINE as alternative [0.02ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle CARGA_HORARIA as alternative [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Alternative Column Names > should handle SITUACAO_CURSO as alternative [0.02ms]
(pass) MEC Row Mapper > mapToMecRow > Edge Cases > should return empty strings for missing columns [0.06ms]
(pass) MEC Row Mapper > mapToMecRow > Edge Cases > should handle partial column maps [0.04ms]
(pass) MEC Row Mapper > mapToMecRow > Edge Cases > should handle values with special characters [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Edge Cases > should prefer first alternative when multiple exist [0.03ms]
(pass) MEC Row Mapper > mapToMecRow > Real-world MEC Data > should parse a typical federal university row [0.06ms]
(pass) MEC Row Mapper > mapToMecRow > Real-world MEC Data > should parse a private EaD institution row [0.04ms]

src/mec-sync/parsers/csv-line.parser.spec.ts:
(pass) CSV Line Parser > parseCsvLine > Basic Parsing > should parse a simple CSV line [0.18ms]
(pass) CSV Line Parser > parseCsvLine > Basic Parsing > should handle empty values [0.04ms]
(pass) CSV Line Parser > parseCsvLine > Basic Parsing > should handle trailing comma [0.03ms]
(pass) CSV Line Parser > parseCsvLine > Basic Parsing > should handle leading comma [0.03ms]
(pass) CSV Line Parser > parseCsvLine > Basic Parsing > should trim whitespace from values [0.03ms]
(pass) CSV Line Parser > parseCsvLine > Quoted Fields > should handle quoted values [0.03ms]
(pass) CSV Line Parser > parseCsvLine > Quoted Fields > should handle commas inside quotes [0.03ms]
(pass) CSV Line Parser > parseCsvLine > Quoted Fields > should handle escaped quotes (double quotes) [0.06ms]
(pass) CSV Line Parser > parseCsvLine > Quoted Fields > should handle multiple quoted fields [0.04ms]
(pass) CSV Line Parser > parseCsvLine > Quoted Fields > should handle empty quoted value [0.03ms]
(pass) CSV Line Parser > parseCsvLine > Edge Cases > should handle empty string [0.02ms]
(pass) CSV Line Parser > parseCsvLine > Edge Cases > should handle single value [0.02ms]
(pass) CSV Line Parser > parseCsvLine > Edge Cases > should handle only commas [0.03ms]
(pass) CSV Line Parser > parseCsvLine > Edge Cases > should handle newlines inside quotes [0.04ms]
(pass) CSV Line Parser > parseCsvLine > Edge Cases > should handle unicode characters [0.09ms]
(pass) CSV Line Parser > parseCsvLine > Edge Cases > should handle special characters [0.05ms]
(pass) CSV Line Parser > parseCsvLine > MEC CSV Specific Cases > should handle typical MEC institution row [0.09ms]
(pass) CSV Line Parser > parseCsvLine > MEC CSV Specific Cases > should handle quoted institution names with commas [0.08ms]
(pass) CSV Line Parser > buildColumnMap > should build a map from header array [0.60ms]
(pass) CSV Line Parser > buildColumnMap > should normalize column names to uppercase [0.20ms]
(pass) CSV Line Parser > buildColumnMap > should trim whitespace from column names [0.04ms]
(pass) CSV Line Parser > buildColumnMap > should remove BOM from first column [0.06ms]
(pass) CSV Line Parser > buildColumnMap > should handle empty header array [0.03ms]
(pass) CSV Line Parser > buildColumnMap > should handle MEC-style headers [0.05ms]
(pass) CSV Line Parser > getColumnValue > should get value by first key match [0.11ms]
(pass) CSV Line Parser > getColumnValue > should try fallback keys in order [0.22ms]
(pass) CSV Line Parser > getColumnValue > should return empty string when no key matches [0.18ms]
(pass) CSV Line Parser > getColumnValue > should return empty string when index is out of bounds [0.34ms]
(pass) CSV Line Parser > getColumnValue > should handle empty values array [0.25ms]
(pass) CSV Line Parser > getColumnValue > should handle multiple fallback keys [0.07ms]
(pass) CSV Line Parser > getColumnValue > should prefer first matching key [0.05ms]

src/mec-sync/services/mec-stats.service.spec.ts:
(pass) MecStatsService > getStats > should return comprehensive statistics [1.56ms]
(pass) MecStatsService > getStats > should include all course degree types [0.77ms]
(pass) MecStatsService > getStats > should include institutions by state [0.51ms]
(pass) MecStatsService > getStats > should handle null degree gracefully [0.43ms]
(pass) MecStatsService > getStats > should fetch all data in parallel [0.42ms]

src/users/services/username.service.spec.ts:
(pass) UsernameService > updateUsername > User validation > should throw NotFoundException when user does not exist [2.84ms]
(pass) UsernameService > updateUsername > User validation > should return success when username is unchanged [0.70ms]
(pass) UsernameService > updateUsername > Username format validation > should reject uppercase letters [0.45ms]
(pass) UsernameService > updateUsername > Username format validation > should reject usernames starting with number [0.33ms]
(pass) UsernameService > updateUsername > Username format validation > should reject special characters [0.29ms]
(pass) UsernameService > updateUsername > Username format validation > should reject consecutive underscores [0.28ms]
(pass) UsernameService > updateUsername > Username format validation > should reject trailing underscore [0.30ms]
(pass) UsernameService > updateUsername > Username format validation > should accept valid lowercase username [0.41ms]
(pass) UsernameService > updateUsername > Username format validation > should accept username with numbers [0.29ms]
(pass) UsernameService > updateUsername > Username format validation > should accept username with single underscores [0.30ms]
(pass) UsernameService > updateUsername > Reserved username validation > should reject "admin" [0.28ms]
(pass) UsernameService > updateUsername > Reserved username validation > should reject "api" [0.39ms]
(pass) UsernameService > updateUsername > Reserved username validation > should reject "www" [0.39ms]
(pass) UsernameService > updateUsername > Reserved username validation > should reject "support" [0.36ms]
(pass) UsernameService > updateUsername > Cooldown validation > should allow when never changed before (null) [0.28ms]
(pass) UsernameService > updateUsername > Cooldown validation > should reject within 30 days of last change [0.55ms]
(pass) UsernameService > updateUsername > Cooldown validation > should allow after 30 days [0.28ms]
(pass) UsernameService > updateUsername > Cooldown validation > should show remaining days in error message [0.36ms]
(pass) UsernameService > updateUsername > Username availability > should reject already taken username [0.57ms]
(pass) UsernameService > updateUsername > Username availability > should accept available username [0.77ms]
(pass) UsernameService > updateUsername > Successful update > should call repository with correct parameters [1.10ms]
(pass) UsernameService > updateUsername > Successful update > should return updated username [0.86ms]
(pass) UsernameService > checkUsernameAvailability > should return available=true when not taken [0.79ms]
(pass) UsernameService > checkUsernameAvailability > should return available=false when taken [0.46ms]
(pass) UsernameService > checkUsernameAvailability > should normalize username to lowercase [0.49ms]

src/users/services/username.service.bug-detection.spec.ts:
(pass) UsernameService - Bug Detection > BUG #1: Uppercase usernames must be REJECTED > should REJECT username containing uppercase letters [2.24ms]
(pass) UsernameService - Bug Detection > BUG #1: Uppercase usernames must be REJECTED > should REJECT username with mixed case [0.59ms]
(pass) UsernameService - Bug Detection > BUG #1: Uppercase usernames must be REJECTED > should REJECT username with single uppercase letter [0.34ms]
(pass) UsernameService - Bug Detection > BUG #1: Uppercase usernames must be REJECTED > should ACCEPT only lowercase username [0.31ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should REJECT reserved username: "admin" [0.28ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should REJECT reserved username: "api" [0.23ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should REJECT reserved username: "www" [0.20ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should REJECT reserved username: "support" [0.20ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should REJECT reserved username: "help" [0.19ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should REJECT reserved username: "root" [0.18ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should REJECT reserved username: "system" [0.16ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should REJECT reserved username: "null" [0.16ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should REJECT reserved username: "undefined" [0.16ms]
(pass) UsernameService - Bug Detection > BUG #2: Reserved usernames must be REJECTED > should include "reserved" in error message [0.31ms]
(pass) UsernameService - Bug Detection > BUG #3: Username format validation > should REJECT username starting with number [0.30ms]
(pass) UsernameService - Bug Detection > BUG #3: Username format validation > should REJECT username with special characters [0.28ms]
(pass) UsernameService - Bug Detection > BUG #3: Username format validation > should REJECT username with spaces [0.25ms]
(pass) UsernameService - Bug Detection > BUG #3: Username format validation > should REJECT username with consecutive underscores [0.24ms]
(pass) UsernameService - Bug Detection > BUG #3: Username format validation > should REJECT username ending with underscore [0.25ms]
(pass) UsernameService - Bug Detection > Cooldown edge cases > should REJECT at exactly 29 days (boundary test) [0.30ms]
(pass) UsernameService - Bug Detection > Cooldown edge cases > should ACCEPT at exactly 30 days (boundary test) [0.29ms]
(pass) UsernameService - Bug Detection > Cooldown edge cases > should show correct remaining days in error message [0.32ms]

src/users/services/user-preferences.service.spec.ts:
(pass) UserPreferencesService > getPreferences > should return user preferences when they exist [1.45ms]
(pass) UserPreferencesService > getPreferences > should throw NotFoundException when preferences do not exist [2.52ms]
(pass) UserPreferencesService > getPreferences > should return empty preferences object when user exists but has no preferences [0.81ms]
(pass) UserPreferencesService > updatePreferences > should update user preferences successfully [0.60ms]
(pass) UserPreferencesService > updatePreferences > should throw NotFoundException when user does not exist [0.37ms]
(pass) UserPreferencesService > updatePreferences > should handle partial preference updates [0.29ms]
(pass) UserPreferencesService > updatePreferences > should handle all preference fields in update [0.29ms]
(pass) UserPreferencesService > getFullPreferences > should return full user preferences when they exist [0.31ms]
(pass) UserPreferencesService > getFullPreferences > should return empty object when full preferences do not exist [0.28ms]
(pass) UserPreferencesService > getFullPreferences > should return empty object when full preferences are undefined [0.25ms]
(pass) UserPreferencesService > updateFullPreferences > should update full user preferences successfully [0.35ms]
(pass) UserPreferencesService > updateFullPreferences > should throw NotFoundException when user does not exist [0.31ms]
(pass) UserPreferencesService > updateFullPreferences > should handle creation of new full preferences (upsert behavior) [0.29ms]
(pass) UserPreferencesService > updateFullPreferences > should handle complete preference set in update [0.29ms]

src/users/services/user-profile.service.spec.ts:
(pass) UserProfileService > getPublicProfileByUsername > should return public profile when user exists and profile is public [0.84ms]
(pass) UserProfileService > getPublicProfileByUsername > should throw NotFoundException when user does not exist [1.74ms]
(pass) UserProfileService > getPublicProfileByUsername > should throw NotFoundException when profile visibility is private [0.55ms]
(pass) UserProfileService > getPublicProfileByUsername > should throw NotFoundException when profile visibility is undefined [0.36ms]
(pass) UserProfileService > getPublicProfileByUsername > should return profile with null resume when user has no resume [0.30ms]
(pass) UserProfileService > getProfile > should return user profile for valid userId [0.34ms]
(pass) UserProfileService > getProfile > should throw NotFoundException when profile does not exist [0.32ms]
(pass) UserProfileService > updateProfile > should update user profile successfully [0.38ms]
(pass) UserProfileService > updateProfile > should throw NotFoundException when user does not exist [0.31ms]
(pass) UserProfileService > updateProfile > should handle partial profile updates [0.26ms]
(pass) UserProfileService > updateProfile > should handle all profile fields in update [0.27ms]

src/ats/parsers/cv-section.parser.redos.spec.ts:
(pass) CVSectionParser - ReDoS BUG DETECTION > BUG-064: ReDoS Vulnerability > should not hang on repeated section headers [1.36ms]
(pass) CVSectionParser - ReDoS BUG DETECTION > BUG-064: ReDoS Vulnerability > should not hang on nested special characters [0.44ms]
(pass) CVSectionParser - ReDoS BUG DETECTION > BUG-064: ReDoS Vulnerability > should not hang on overlapping patterns [0.32ms]
(pass) CVSectionParser - ReDoS BUG DETECTION > BUG-064: ReDoS Vulnerability > should limit input size [2.98ms]

src/ats/parsers/cv-section.parser.spec.ts:
(pass) CVSectionParser > parseCV > Basic Parsing > should parse a CV with all standard sections [0.42ms]
(pass) CVSectionParser > parseCV > Basic Parsing > should preserve section order in the order field [0.22ms]
(pass) CVSectionParser > parseCV > Basic Parsing > should capture multi-line content within sections [0.17ms]
(pass) CVSectionParser > parseCV > Basic Parsing > should track line numbers for sections [0.17ms]
(pass) CVSectionParser > parseCV > Edge Cases > should handle empty input [0.10ms]
(pass) CVSectionParser > parseCV > Edge Cases > should handle whitespace-only input [0.06ms]
(pass) CVSectionParser > parseCV > Edge Cases > should handle text with no detectable sections [0.11ms]
(pass) CVSectionParser > parseCV > Edge Cases > should handle very short lines (under 3 chars) as non-headers [0.23ms]
(pass) CVSectionParser > parseCV > Edge Cases > should handle lines with too many words as non-headers [0.20ms]
(pass) CVSectionParser > parseCV > Edge Cases > should handle section with no content after it [0.17ms]
(pass) CVSectionParser > parseCV > Section Alias Detection > should detect "Work Experience" as EXPERIENCE [0.10ms]
(pass) CVSectionParser > parseCV > Section Alias Detection > should detect "Professional Experience" as EXPERIENCE [0.08ms]
(pass) CVSectionParser > parseCV > Section Alias Detection > should detect "Contact Information" as PERSONAL_INFO [0.11ms]
(pass) CVSectionParser > parseCV > Section Alias Detection > should detect "Career Objective" as SUMMARY [0.10ms]
(pass) CVSectionParser > parseCV > Section Alias Detection > should detect "Technical Skills" as SKILLS [0.08ms]
(pass) CVSectionParser > parseCV > Section Alias Detection > should detect "Educational Background" as EDUCATION [0.11ms]
(pass) CVSectionParser > parseCV > Portuguese Section Detection > should detect "ExperiÃªncia" as EXPERIENCE [0.21ms]
(pass) CVSectionParser > parseCV > Portuguese Section Detection > should detect "FormaÃ§Ã£o AcadÃªmica" as EDUCATION [0.11ms]
(pass) CVSectionParser > parseCV > Portuguese Section Detection > should detect "Habilidades" as SKILLS [0.08ms]
(pass) CVSectionParser > parseCV > Portuguese Section Detection > should detect "Idiomas" as LANGUAGES [0.09ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Personal Info" as personal_info [0.09ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Summary" as summary [0.05ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Experience" as experience [0.04ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Education" as education [0.04ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Skills" as skills [0.03ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Certifications" as certifications [0.05ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Projects" as projects [0.04ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Awards" as awards [0.04ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Publications" as publications [0.03ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Languages" as languages [0.04ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "Interests" as interests [0.06ms]
(pass) CVSectionParser > parseCV > All Section Types > should detect "References" as references [0.09ms]
(pass) CVSectionParser > parseCV > Unicode and Special Characters > should handle accented characters in section headers [0.14ms]
(pass) CVSectionParser > parseCV > Unicode and Special Characters > should handle special characters in content [0.13ms]
(pass) CVSectionParser > parseCV > Unicode and Special Characters > should handle emoji in content [0.09ms]
(pass) CVSectionParser > validateSections > Passing Validation > should pass when all mandatory sections are present with enough content [0.53ms]
(pass) CVSectionParser > validateSections > Passing Validation > should report detected sections correctly [0.12ms]
(pass) CVSectionParser > validateSections > Missing Sections > should fail when EXPERIENCE is missing [0.18ms]
(pass) CVSectionParser > validateSections > Missing Sections > should fail when EDUCATION is missing [0.10ms]
(pass) CVSectionParser > validateSections > Missing Sections > should fail when SKILLS is missing [0.09ms]
(pass) CVSectionParser > validateSections > Missing Sections > should report all missing mandatory sections [0.09ms]
(pass) CVSectionParser > validateSections > Empty Sections > should warn about sections with less than 10 characters [0.17ms]
(pass) CVSectionParser > validateSections > Duplicate Sections > should warn about duplicate sections [0.18ms]
(pass) CVSectionParser > validateSections > Duplicate Sections > should allow duplicates but warn (not fail) [0.17ms]
(pass) CVSectionParser > validateSections > No Sections Detected > should fail when no sections are detected [0.10ms]
(pass) CVSectionParser > validateSections > No Sections Detected > should provide helpful suggestion when no sections detected [0.07ms]
(pass) CVSectionParser > validateSections > Metadata > should report total and unique section counts [0.14ms]

src/ats/validators/layout-safety.validator.spec.ts:
(pass) LayoutSafetyValidator > validate > should pass validation for clean, ATS-friendly text [0.49ms]
(pass) LayoutSafetyValidator > validate > should detect unsafe bullet characters [0.17ms]
(pass) LayoutSafetyValidator > validate > should provide appropriate suggestion for unsafe bullets [0.07ms]
(pass) LayoutSafetyValidator > validate > should detect text inside shapes [0.07ms]
(pass) LayoutSafetyValidator > validate > should detect text inside double-box shapes [0.05ms]
(pass) LayoutSafetyValidator > validate > should detect text inside ASCII box shapes [0.07ms]
(pass) LayoutSafetyValidator > validate > should detect multi-column layout [0.06ms]
(pass) LayoutSafetyValidator > validate > should not detect multi-column for regular spacing [0.03ms]
(pass) LayoutSafetyValidator > validate > should detect excessive line breaks [0.06ms]
(pass) LayoutSafetyValidator > validate > should allow moderate blank lines (1-2) [0.04ms]
(pass) LayoutSafetyValidator > validate > should detect horizontal lines with dashes [0.04ms]
(pass) LayoutSafetyValidator > validate > should detect horizontal lines with equals signs [0.03ms]
(pass) LayoutSafetyValidator > validate > should detect horizontal lines with underscores [0.03ms]
(pass) LayoutSafetyValidator > validate > should detect horizontal lines with Unicode characters [0.03ms]
(pass) LayoutSafetyValidator > validate > should not detect short dash sequences as horizontal lines [0.03ms]
(pass) LayoutSafetyValidator > validate > should detect multiple ATS layout issues simultaneously [0.08ms]
(pass) LayoutSafetyValidator > validate > should never fail with ERROR severity (all issues are WARNING/INFO) [0.06ms]
(pass) LayoutSafetyValidator > validate > should provide metadata summary [0.05ms]
(pass) LayoutSafetyValidator > validate > should handle empty text gracefully [0.04ms]
(pass) LayoutSafetyValidator > validate > should handle text with only whitespace [0.03ms]
(pass) LayoutSafetyValidator > validate > should detect all defined unsafe bullet types [0.06ms]

src/ats/validators/grammar.validator.spec.ts:
(pass) GrammarValidator > validate > should return passed=true for clean text with no issues [1.41ms]
(pass) GrammarValidator > validate > should return passed=false when spelling errors exist [0.58ms]
(pass) GrammarValidator > validate > should provide metadata about total issues and categories [0.52ms]
(pass) GrammarValidator > spelling validation > should detect common spelling mistakes [0.49ms]
(pass) GrammarValidator > spelling validation > should suggest correct spelling for mistakes [0.42ms]
(pass) GrammarValidator > spelling validation > should not report duplicate spelling mistakes [0.37ms]
(pass) GrammarValidator > spelling validation > should be case-insensitive for spelling checks [0.33ms]
(pass) GrammarValidator > spelling validation > should detect multiple different spelling mistakes [0.31ms]
(pass) GrammarValidator > grammar patterns > should detect article errors (a before vowel) [0.32ms]
(pass) GrammarValidator > grammar patterns > should detect multiple consecutive spaces [0.29ms]
(pass) GrammarValidator > grammar patterns > should detect sentences not starting with capital letters [0.33ms]
(pass) GrammarValidator > grammar patterns > should flag commonly confused words [0.53ms]
(pass) GrammarValidator > structure validation > should flag very long sentences [0.36ms]
(pass) GrammarValidator > structure validation > should not flag reasonably sized sentences [0.25ms]
(pass) GrammarValidator > structure validation > should warn about documents with too few sentences [0.24ms]
(pass) GrammarValidator > structure validation > should accept documents with adequate number of sentences [0.21ms]
(pass) GrammarValidator > repeated words detection > should detect consecutive repeated words [0.24ms]
(pass) GrammarValidator > repeated words detection > should not flag intentionally repeated words in different contexts [0.23ms]
(pass) GrammarValidator > repeated words detection > should count multiple instances of repeated words [0.29ms]
(pass) GrammarValidator > comprehensive validation > should handle empty text gracefully [0.26ms]
(pass) GrammarValidator > comprehensive validation > should handle text with mixed issues [0.27ms]
(pass) GrammarValidator > comprehensive validation > should categorize issues by severity correctly [0.26ms]

src/themes/utils/deep-merge.util.spec.ts:
(pass) deepMerge > basic merging > should merge flat objects [0.12ms]
(pass) deepMerge > basic merging > should not mutate original objects [0.02ms]
(pass) deepMerge > basic merging > should return base when overrides is empty [0.01ms]
(pass) deepMerge > nested objects > should merge nested objects recursively [0.03ms]
(pass) deepMerge > nested objects > should handle deeply nested objects [0.03ms]
(pass) deepMerge > null values > should handle null values correctly - override replaces [0.02ms]
(pass) deepMerge > null values > should handle null in base object
(pass) deepMerge > array handling > should replace arrays instead of merging [0.02ms]
(pass) deepMerge > array handling > should not deep merge array contents [0.02ms]
(pass) deepMerge > undefined handling > should skip undefined values in overrides [0.02ms]
(pass) deepMerge > type coercion edge cases > should handle primitive override over object [0.01ms]
(pass) deepMerge > type coercion edge cases > should handle object override over primitive [0.01ms]
(pass) deepMerge > type coercion edge cases > should handle boolean values [0.01ms]
(pass) deepMerge > type coercion edge cases > should handle string values [0.02ms]
(pass) deepMerge > real-world theme config scenarios > should merge theme styleConfig correctly [0.04ms]

src/themes/utils/ordering.util.spec.ts:
(pass) sortByOrder > should sort items by order property ascending [0.08ms]
(pass) sortByOrder > should not mutate original array [0.02ms]
(pass) sortByOrder > should handle empty array [0.02ms]
(pass) sortByOrder > should handle single item [0.01ms]
(pass) sortByOrder > should handle items with same order [0.01ms]
(pass) normalizeOrders > should normalize orders to sequential values (0, 1, 2...) [0.05ms]
(pass) normalizeOrders > should not mutate original items [0.02ms]
(pass) normalizeOrders > should handle empty array [0.02ms]
(pass) normalizeOrders > should handle already normalized orders [0.02ms]
(pass) moveItem > should attempt to move item but normalizeOrders sorts by original order [0.07ms]
(pass) moveItem > should handle moving to same position [0.03ms]
(pass) moveItem > should not mutate original array [0.03ms]
(pass) moveItem > should normalize orders after operation [0.04ms]
(pass) moveItem > should handle single item array [0.02ms]
(pass) applyItemOverrides > should add visible and order when no overrides [0.07ms]
(pass) applyItemOverrides > should add visible and order when overrides is empty array [0.02ms]
(pass) applyItemOverrides > should apply visibility overrides [0.05ms]
(pass) applyItemOverrides > should apply order overrides [0.03ms]
(pass) applyItemOverrides > should handle items without matching overrides [0.03ms]
(pass) applyItemOverrides > should preserve original item properties [0.03ms]

src/themes/services/section-visibility.service.spec.ts:
(pass) SectionVisibilityService > toggleSection > should hide a visible section [0.77ms]
(pass) SectionVisibilityService > toggleSection > should show a hidden section [0.43ms]
(pass) SectionVisibilityService > toggleSection > should not modify other sections [0.32ms]
(pass) SectionVisibilityService > toggleSection > should not modify section if id not found [0.26ms]
(pass) SectionVisibilityService > toggleItem > should hide a visible item [0.40ms]
(pass) SectionVisibilityService > toggleItem > should show a hidden item [0.30ms]
(pass) SectionVisibilityService > toggleItem > should add new item override if not exists [0.26ms]
(pass) SectionVisibilityService > toggleItem > should preserve order when toggling visibility [0.27ms]
(pass) SectionVisibilityService > toggleItem > should not modify other items in the same section [0.26ms]
(pass) SectionVisibilityService > toggleItem > should create section override array if not exists [0.24ms]

src/themes/services/theme-crud.service.spec.ts:
(pass) ThemeCrudService > create > should create theme successfully [0.69ms]
(pass) ThemeCrudService > create > should validate layout config if provided [0.30ms]
(pass) ThemeCrudService > update > should update theme owned by user [0.39ms]
(pass) ThemeCrudService > update > should reject updating theme owned by different user [1.65ms]
(pass) ThemeCrudService > update > should allow admin to update system theme [0.64ms]
(pass) ThemeCrudService > update > should reject non-admin updating system theme [0.35ms]
(pass) ThemeCrudService > update > should throw NotFoundException for non-existent theme [0.26ms]
(pass) ThemeCrudService > delete > should delete theme owned by user [0.32ms]
(pass) ThemeCrudService > delete > should reject deleting theme owned by different user [0.28ms]
(pass) ThemeCrudService > delete > should reject deleting system theme [0.27ms]
(pass) ThemeCrudService > delete > should throw NotFoundException for non-existent theme [0.26ms]
(pass) ThemeCrudService > findOrFail > should return theme when found [0.21ms]
(pass) ThemeCrudService > findOrFail > should throw NotFoundException when not found [0.23ms]

src/themes/services/theme-approval.service.spec.ts:
(pass) ThemeApprovalService > submitForApproval > should submit PRIVATE theme â PENDING_APPROVAL [0.77ms]
(pass) ThemeApprovalService > submitForApproval > should submit REJECTED theme â PENDING_APPROVAL (resubmit) [0.35ms]
(pass) ThemeApprovalService > submitForApproval > should reject submission if not theme owner [1.68ms]
(pass) ThemeApprovalService > submitForApproval > should reject submission of already published theme [0.57ms]
(pass) ThemeApprovalService > submitForApproval > should reject submission of pending theme [0.34ms]
(pass) ThemeApprovalService > review - approve > should approve: PENDING_APPROVAL â PUBLISHED [0.52ms]
(pass) ThemeApprovalService > review - approve > should allow admin to approve themes [0.30ms]
(pass) ThemeApprovalService > review - reject > should reject: PENDING_APPROVAL â REJECTED [0.33ms]
(pass) ThemeApprovalService > review - reject > should require rejection reason when rejecting [0.29ms]
(pass) ThemeApprovalService > review - access control > should reject non-admin/non-approver approval attempts [0.26ms]
(pass) ThemeApprovalService > review - access control > should reject self-approval [0.31ms]
(pass) ThemeApprovalService > review - access control > should reject approval of non-pending themes [0.30ms]
(pass) ThemeApprovalService > review - access control > should reject approval of already published themes [0.24ms]
(pass) ThemeApprovalService > getPendingApprovals > should return pending themes for approver [0.32ms]
(pass) ThemeApprovalService > getPendingApprovals > should reject non-approver access [0.30ms]
(pass) ThemeApprovalService > getPendingApprovals > should allow admin access [0.21ms]
(pass) ThemeApprovalService > workflow: full approval cycle > should complete: PRIVATE â submit â PENDING â approve â PUBLISHED [0.36ms]
(pass) ThemeApprovalService > workflow: full approval cycle > should complete: PRIVATE â submit â PENDING â reject â REJECTED â resubmit â PENDING [0.43ms]

src/themes/services/section-ordering.service.spec.ts:

# Unhandled error between tests
-------------------------------
25 |   normalizeOrders: mock((items) =>
                      ^
error: Expected ";" but found ":"
    at /home/ilelo/Documents/Projects/profile/profile-services/src/themes/services/section-ordering.service.spec.ts:25:18

31 | }));
     ^
error: Unexpected }
    at /home/ilelo/Documents/Projects/profile/profile-services/src/themes/services/section-ordering.service.spec.ts:31:1
-------------------------------


src/themes/services/theme-query.service.bug.spec.ts:
45 |       );
46 | 
47 |       // BUG: No limit enforced!
48 |       await (service as any).search?.('test', 10000);
49 | 
50 |       const findManyCall = mockPrisma.resumeTheme.findMany.mock.calls[0][0];
                                                                           ^
TypeError: undefined is not an object (evaluating 'mockPrisma.resumeTheme.findMany.mock.calls[0][0]')
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/themes/services/theme-query.service.bug.spec.ts:50:71)
(fail) ThemeQueryService - BUG DETECTION > BUG-051: No Pagination Limit > should enforce maximum limit on search [1.00ms]
59 |       await (service as any).search?.('test');
60 | 
61 |       const findManyCall = mockPrisma.resumeTheme.findMany.mock.calls[0]?.[0];
62 | 
63 |       // Should have a default limit
64 |       expect(findManyCall?.take).toBeDefined();
                                      ^
error: expect(received).toBeDefined()

Received: undefined

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/themes/services/theme-query.service.bug.spec.ts:64:34)
(fail) ThemeQueryService - BUG DETECTION > BUG-051: No Pagination Limit > should have default limit when none provided [0.46ms]
(pass) ThemeQueryService - BUG DETECTION > BUG-059: Style Config Size Not Validated > should reject excessively large styleConfig [12.96ms]
(pass) ThemeQueryService - BUG DETECTION > BUG-059: Style Config Size Not Validated > should reject deeply nested styleConfig [0.74ms]

src/onboarding/services/skills-onboarding.service.spec.ts:
(pass) SkillsOnboardingService > saveSkills > should save skills with correct order [1.11ms]
(pass) SkillsOnboardingService > saveSkills > should use empty string for missing category [0.43ms]
(pass) SkillsOnboardingService > saveSkills > should not save skills when noSkills is true [0.26ms]
(pass) SkillsOnboardingService > saveSkills > should not save skills when skills array is empty [0.24ms]
(pass) SkillsOnboardingService > saveSkills > should replace existing skills [0.28ms]
(pass) SkillsOnboardingService > saveSkills > should set level to null for all skills [0.27ms]

src/onboarding/services/education-onboarding.service.spec.ts:
(pass) EducationOnboardingService > saveEducation > should save education with all fields [1.24ms]
(pass) EducationOnboardingService > saveEducation > should save current education with null endDate [0.50ms]
(pass) EducationOnboardingService > saveEducation > should skip education with invalid startDate [0.35ms]
(pass) EducationOnboardingService > saveEducation > should skip education with endDate before startDate [0.28ms]
(pass) EducationOnboardingService > saveEducation > should not save education when noEducation is true [0.24ms]
(pass) EducationOnboardingService > saveEducation > should not save education when array is empty [0.21ms]
(pass) EducationOnboardingService > saveEducation > should allow empty field [0.22ms]
(pass) EducationOnboardingService > saveEducation > should replace existing education [0.23ms]

src/onboarding/services/experience-onboarding.service.spec.ts:
(pass) ExperienceOnboardingService > saveExperiences > should save experience with all fields [1.08ms]
(pass) ExperienceOnboardingService > saveExperiences > should save current experience with null endDate [0.35ms]
(pass) ExperienceOnboardingService > saveExperiences > should skip experience with invalid startDate [0.34ms]
(pass) ExperienceOnboardingService > saveExperiences > should skip experience with endDate before startDate [0.33ms]
(pass) ExperienceOnboardingService > saveExperiences > should not save experiences when noExperience is true [0.24ms]
(pass) ExperienceOnboardingService > saveExperiences > should not save experiences when array is empty [0.21ms]
(pass) ExperienceOnboardingService > saveExperiences > should use empty string for missing description [0.21ms]
(pass) ExperienceOnboardingService > saveExperiences > should replace existing experiences [0.26ms]

src/onboarding/services/onboarding-progress.bug-detection.spec.ts:
(pass) OnboardingProgressService - Bug Detection > BUG #5: Flag + non-empty array validation > should REJECT noExperience=true with non-empty experiences array [1.12ms]
(pass) OnboardingProgressService - Bug Detection > BUG #5: Flag + non-empty array validation > should REJECT noEducation=true with non-empty education array [0.40ms]
(pass) OnboardingProgressService - Bug Detection > BUG #5: Flag + non-empty array validation > should REJECT noSkills=true with non-empty skills array [0.30ms]
(pass) OnboardingProgressService - Bug Detection > BUG #5: Flag + non-empty array validation > should include "cannot" or "forbidden" in error message [0.37ms]
(pass) OnboardingProgressService - Bug Detection > BUG #5: Flag + non-empty array validation > should ACCEPT noExperience=true with empty experiences array [0.31ms]
(pass) OnboardingProgressService - Bug Detection > BUG #6: Progress expiration after 36 hours > should return INITIAL progress if existing progress is older than 36 hours [0.42ms]
(pass) OnboardingProgressService - Bug Detection > BUG #6: Progress expiration after 36 hours > should DELETE expired progress automatically [0.24ms]
(pass) OnboardingProgressService - Bug Detection > BUG #6: Progress expiration after 36 hours > should KEEP progress if less than 36 hours old [0.25ms]
(pass) OnboardingProgressService - Bug Detection > BUG #6: Progress expiration after 36 hours > should check expiration at exactly 36 hours (boundary) [0.23ms]
242 |       await expect(
243 |         service.saveProgress('user-123', {
244 |           currentStep: 'skills',
245 |           completedSteps: ['welcome'], // Missing personal-info, professional-profile, etc.
246 |         }),
247 |       ).rejects.toThrow(BadRequestException);
                      ^
error: expect(received).toThrow(expected)

Expected constructor: BadRequestException
Received constructor: TypeError

Received message: "undefined is not an object (evaluating 'progress.currentStep')"

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/onboarding/services/onboarding-progress.bug-detection.spec.ts:247:17)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/onboarding/services/onboarding-progress.bug-detection.spec.ts:241:57)
(fail) OnboardingProgressService - Bug Detection > Sequential step validation > should REJECT skipping from welcome to skills [0.32ms]
252 |         service.saveProgress('user-123', {
253 |           currentStep: 'education',
254 |           completedSteps: ['welcome', 'personal-info', 'professional-profile'],
255 |           // Missing 'experience' in completedSteps
256 |         }),
257 |       ).rejects.toThrow(BadRequestException);
                      ^
error: expect(received).toThrow(expected)

Expected constructor: BadRequestException
Received constructor: TypeError

Received message: "undefined is not an object (evaluating 'progress.currentStep')"

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/onboarding/services/onboarding-progress.bug-detection.spec.ts:257:17)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/onboarding/services/onboarding-progress.bug-detection.spec.ts:250:79)
(fail) OnboardingProgressService - Bug Detection > Sequential step validation > should REJECT going to education without completing experience step [1.86ms]
(pass) OnboardingProgressService - Bug Detection > Sequential step validation > should ACCEPT valid sequential progress [0.31ms]

src/onboarding/services/resume-onboarding.service.spec.ts:
(pass) ResumeOnboardingService > upsertResume > should create new resume with all personal info fields [2.65ms]
(pass) ResumeOnboardingService > upsertResume > should create resume with professional profile links [1.16ms]
(pass) ResumeOnboardingService > upsertResume > should set primary resume when creating first resume for user [0.72ms]
(pass) ResumeOnboardingService > upsertResume > should not change primary resume when updating existing resume [7.80ms]
(pass) ResumeOnboardingService > upsertResume > should update existing resume instead of creating new one [0.65ms]
(pass) ResumeOnboardingService > upsertResume > should handle different template selections [0.33ms]

src/onboarding/services/onboarding-progress.service.spec.ts:
(pass) OnboardingProgressService > saveProgress > Flag + Array Validation > should reject noExperience=true with non-empty experiences [0.65ms]
(pass) OnboardingProgressService > saveProgress > Flag + Array Validation > should reject noEducation=true with non-empty education [0.35ms]
(pass) OnboardingProgressService > saveProgress > Flag + Array Validation > should reject noSkills=true with non-empty skills [0.28ms]
(pass) OnboardingProgressService > saveProgress > Flag + Array Validation > should accept noExperience=true with empty experiences [0.34ms]
(pass) OnboardingProgressService > saveProgress > Username Validation > should reject if username is taken by another user [1.60ms]
(pass) OnboardingProgressService > saveProgress > Username Validation > should accept if username belongs to same user [0.47ms]
(pass) OnboardingProgressService > saveProgress > Username Validation > should accept if username is available [0.30ms]
(pass) OnboardingProgressService > saveProgress > Successful Save > should call prisma upsert with correct data [0.27ms]
(pass) OnboardingProgressService > saveProgress > Successful Save > should return success with current step [0.25ms]
(pass) OnboardingProgressService > getProgress > Expiration (36 hours) > should return initial progress if no saved progress [0.23ms]
(pass) OnboardingProgressService > getProgress > Expiration (36 hours) > should return saved progress if fresh [0.25ms]
(pass) OnboardingProgressService > getProgress > Expiration (36 hours) > should return initial progress and delete if expired (>36h) [0.25ms]
(pass) OnboardingProgressService > getProgress > Expiration (36 hours) > should keep progress at exactly 35 hours [0.26ms]
(pass) OnboardingProgressService > deleteProgress > should delete progress for user [0.22ms]

src/onboarding/services/languages-onboarding.service.spec.ts:
(pass) LanguagesOnboardingService > saveLanguages > should save languages with correct order [0.86ms]
(pass) LanguagesOnboardingService > saveLanguages > should not save languages when array is empty [0.44ms]
(pass) LanguagesOnboardingService > saveLanguages > should replace existing languages [0.34ms]
(pass) LanguagesOnboardingService > saveLanguages > should map name field to name in storage [0.28ms]
(pass) LanguagesOnboardingService > saveLanguages > should map level field to level in storage [0.26ms]
(pass) LanguagesOnboardingService > saveLanguages > should handle single language [0.24ms]

src/tech-skills/services/tech-skills-query.service.spec.ts:
(pass) TechSkillsQueryService (Facade) > getAllAreas > should return list of tech areas [0.64ms]
(pass) TechSkillsQueryService (Facade) > getAllNiches > should return list of tech niches [0.36ms]
(pass) TechSkillsQueryService (Facade) > getNichesByArea > should return niches filtered by area [0.28ms]
(pass) TechSkillsQueryService (Facade) > getAllLanguages > should return list of programming languages [0.25ms]
(pass) TechSkillsQueryService (Facade) > searchLanguages > should return languages matching query [0.28ms]
(pass) TechSkillsQueryService (Facade) > getAllSkills > should return list of tech skills [0.24ms]
(pass) TechSkillsQueryService (Facade) > getSkillsByNiche > should return skills for specific niche [0.27ms]
(pass) TechSkillsQueryService (Facade) > getSkillsByType > should return skills of specific type [0.26ms]
(pass) TechSkillsQueryService (Facade) > searchSkills > should return skills matching query [0.26ms]
173 | 
174 |       expect(result).toMatchObject({
175 |         languages: expect.any(Array),
176 |         skills: expect.any(Array),
177 |       });
178 |       expect(result.languages).toHaveLength(1);
                                     ^
error: Received value does not have a length property: Any<Array>
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/tech-skills/services/tech-skills-query.service.spec.ts:178:32)
(fail) TechSkillsQueryService (Facade) > searchAll > should return combined results of languages and skills [0.40ms]

src/tech-skills/services/niche-query.service.spec.ts:
(pass) TechNicheQueryService > getAllNiches > should return all niches with area information [0.81ms]
79 | 
80 |     it('should cache results', async () => {
81 |       await service.getAllNiches();
82 |       await service.getAllNiches();
83 | 
84 |       expect(stubPrisma.techNiche.findMany).toHaveBeenCalledTimes(1);
                                                 ^
error: expect(received).toHaveBeenCalledTimes(expected)

Expected number of calls: 1
Received number of calls: 2

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/tech-skills/services/niche-query.service.spec.ts:84:45)
(fail) TechNicheQueryService > getAllNiches > should cache results [0.41ms]
(pass) TechNicheQueryService > getNichesByArea > should return niches filtered by area type [0.38ms]

src/tech-skills/services/language-query.service.spec.ts:
(pass) LanguageQueryService > getAllLanguages > should return all programming languages [0.70ms]
76 | 
77 |     it('should cache results', async () => {
78 |       await service.getAllLanguages();
79 |       await service.getAllLanguages();
80 | 
81 |       expect(stubPrisma.programmingLanguage.findMany).toHaveBeenCalledTimes(1);
                                                           ^
error: expect(received).toHaveBeenCalledTimes(expected)

Expected number of calls: 1
Received number of calls: 2

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/tech-skills/services/language-query.service.spec.ts:81:55)
(fail) LanguageQueryService > getAllLanguages > should cache results [0.44ms]
(pass) LanguageQueryService > searchLanguages > should return languages matching query [0.47ms]
(pass) LanguageQueryService > searchLanguages > should return empty array for empty query [0.26ms]
(pass) LanguageQueryService > searchLanguages > should respect limit parameter [0.24ms]

src/tech-skills/services/area-query.service.spec.ts:
(pass) TechAreaQueryService > getAllAreas > should return all active tech areas [0.93ms]
(pass) TechAreaQueryService > getAllAreas > should include all area fields [0.40ms]
101 |     });
102 | 
103 |     it('should return cached results on second call', async () => {
104 |       // First call - should query DB
105 |       await service.getAllAreas();
106 |       expect(stubPrisma.techArea.findMany).toHaveBeenCalledTimes(1);
                                                 ^
error: expect(received).toHaveBeenCalledTimes(expected)

Expected number of calls: 1
Received number of calls: 3

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/tech-skills/services/area-query.service.spec.ts:106:44)
(fail) TechAreaQueryService > getAllAreas > should return cached results on second call [0.36ms]
(pass) TechAreaQueryService > getAllAreas > should store results in cache after first query [0.26ms]
121 |     });
122 | 
123 |     it('should return results sorted by order', async () => {
124 |       const result = await service.getAllAreas();
125 | 
126 |       expect(result[0].order).toBeLessThan(result[1].order);
                                    ^
error: Expected and actual values must be numbers or bigints
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/tech-skills/services/area-query.service.spec.ts:126:31)
(fail) TechAreaQueryService > getAllAreas > should return results sorted by order [0.27ms]

src/tech-skills/services/skill-search.service.spec.ts:
(pass) SkillSearchService > searchSkills > should return skills matching query [1.28ms]
(pass) SkillSearchService > searchSkills > should return empty array for empty query [0.46ms]
(pass) SkillSearchService > searchSkills > should return empty array for whitespace query [0.34ms]
(pass) SkillSearchService > searchSkills > should normalize query to lowercase [0.36ms]
(pass) SkillSearchService > searchSkills > should return consistent results on multiple calls [0.31ms]
(pass) SkillSearchService > searchSkills > should respect limit parameter [0.29ms]
(pass) SkillSearchService > searchSkills > should include niche information in results [0.28ms]

src/tech-skills/services/skill-query.service.spec.ts:
(pass) SkillQueryService > getAllSkills > should return all skills with niche information [2.33ms]
79 | 
80 |     it('should cache results', async () => {
81 |       await service.getAllSkills();
82 |       await service.getAllSkills();
83 | 
84 |       expect(stubPrisma.techSkill.findMany).toHaveBeenCalledTimes(1);
                                                 ^
error: expect(received).toHaveBeenCalledTimes(expected)

Expected number of calls: 1
Received number of calls: 2

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/tech-skills/services/skill-query.service.spec.ts:84:45)
(fail) SkillQueryService > getAllSkills > should cache results [1.63ms]
(pass) SkillQueryService > getSkillsByNiche > should return skills filtered by niche slug [1.40ms]
(pass) SkillQueryService > getSkillsByType > should return skills filtered by type [0.97ms]
(pass) SkillQueryService > getSkillsByType > should respect limit parameter [0.70ms]

src/spoken-languages/services/spoken-languages.service.spec.ts:
(pass) SpokenLanguagesService > getAll > should return all active languages ordered by order field [1.35ms]
(pass) SpokenLanguagesService > getAll > should filter out inactive languages [0.60ms]
(pass) SpokenLanguagesService > getAll > should return empty array when no languages found [0.48ms]
(pass) SpokenLanguagesService > getAll > should handle null nativeName correctly [0.47ms]
(pass) SpokenLanguagesService > search > should search languages by English name case-insensitively [0.54ms]
(pass) SpokenLanguagesService > search > should search languages by Portuguese name [0.43ms]
(pass) SpokenLanguagesService > search > should search languages by Spanish name [0.40ms]
(pass) SpokenLanguagesService > search > should search languages by native name [0.43ms]
(pass) SpokenLanguagesService > search > should apply default limit when not specified [0.46ms]
(pass) SpokenLanguagesService > search > should respect custom limit parameter [0.39ms]
(pass) SpokenLanguagesService > search > should order search results by order field [0.40ms]
(pass) SpokenLanguagesService > search > should only search active languages [0.38ms]
(pass) SpokenLanguagesService > search > should return empty array when no matches found [0.36ms]
(pass) SpokenLanguagesService > getByCode > should return language by code [0.45ms]
(pass) SpokenLanguagesService > getByCode > should return null when language not found [0.36ms]
(pass) SpokenLanguagesService > getByCode > should handle language with null native name [0.38ms]
(pass) SpokenLanguagesService > getByCode > should query by exact code [0.39ms]

src/auth/strategies/jwt.strategy.spec.ts:
59 |     }
60 | 
61 |     // BUG-023/055/056/057 FIX: Enforce token revocation after security events
62 |     // passport-jwt includes standard claims like iat (seconds since epoch)
63 |     const issuedAtMs = (payload.iat ?? 0) * 1000;
64 |     const isRevoked = await this.tokenBlacklist.isTokenRevokedForUser(
                                                     ^
TypeError: this.tokenBlacklist.isTokenRevokedForUser is not a function. (In 'this.tokenBlacklist.isTokenRevokedForUser(user.id, issuedAtMs)', 'this.tokenBlacklist.isTokenRevokedForUser' is undefined)
      at validate (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/strategies/jwt.strategy.ts:64:49)
      at async <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/strategies/jwt.strategy.spec.ts:73:37)
(fail) JwtStrategy > validate > should return user payload when user exists [2.28ms]
(pass) JwtStrategy > validate > should throw UnauthorizedException when user does not exist [3.41ms]
59 |     }
60 | 
61 |     // BUG-023/055/056/057 FIX: Enforce token revocation after security events
62 |     // passport-jwt includes standard claims like iat (seconds since epoch)
63 |     const issuedAtMs = (payload.iat ?? 0) * 1000;
64 |     const isRevoked = await this.tokenBlacklist.isTokenRevokedForUser(
                                                     ^
TypeError: this.tokenBlacklist.isTokenRevokedForUser is not a function. (In 'this.tokenBlacklist.isTokenRevokedForUser(user.id, issuedAtMs)', 'this.tokenBlacklist.isTokenRevokedForUser' is undefined)
      at validate (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/strategies/jwt.strategy.ts:64:49)
      at async <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/strategies/jwt.strategy.spec.ts:109:37)
(fail) JwtStrategy > validate > should return correct onboarding status [0.76ms]
59 |     }
60 | 
61 |     // BUG-023/055/056/057 FIX: Enforce token revocation after security events
62 |     // passport-jwt includes standard claims like iat (seconds since epoch)
63 |     const issuedAtMs = (payload.iat ?? 0) * 1000;
64 |     const isRevoked = await this.tokenBlacklist.isTokenRevokedForUser(
                                                     ^
TypeError: this.tokenBlacklist.isTokenRevokedForUser is not a function. (In 'this.tokenBlacklist.isTokenRevokedForUser(user.id, issuedAtMs)', 'this.tokenBlacklist.isTokenRevokedForUser' is undefined)
      at validate (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/strategies/jwt.strategy.ts:64:49)
      at async <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/strategies/jwt.strategy.spec.ts:127:37)
(fail) JwtStrategy > validate > should return admin role when user is admin [0.43ms]
142 |             JwtStrategy,
143 |             { provide: PrismaService, useValue: prisma },
144 |             { provide: ConfigService, useValue: mockConfigService },
145 |           ],
146 |         }).compile(),
147 |       ).rejects.toThrow('JWT_SECRET environment variable is required');
                      ^
error: expect(received).toThrow(expected)

Expected substring: "JWT_SECRET environment variable is required"
Received message: "Nest can't resolve dependencies of the JwtStrategy (ConfigService, PrismaService, ?). Please make sure that the argument TokenBlacklistService at index [2] is available in the RootTestModule context.\n\nPotential solutions:\n- Is RootTestModule a valid NestJS module?\n- If TokenBlacklistService is a provider, is it part of the current RootTestModule?\n- If TokenBlacklistService is exported from a separate @Module, is that module imported within RootTestModule?\n  @Module({\n    imports: [ /* the Module containing TokenBlacklistService */ ]\n  })\n\nFor more common dependency resolution issues, see: https://docs.nestjs.com/faq/common-errors"

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/strategies/jwt.strategy.spec.ts:147:17)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/strategies/jwt.strategy.spec.ts:134:64)
(fail) JwtStrategy > constructor > should throw error when JWT_SECRET is not configured [1.39ms]

src/auth/strategies/jwt.strategy.bug-detection.spec.ts:
(pass) JwtStrategy - BUG DETECTION > BUG-009: Email Verification Enforcement > should REJECT user with unverified email (emailVerified = null) [2.25ms]
(pass) JwtStrategy - BUG DETECTION > BUG-009: Email Verification Enforcement > should ALLOW user with verified email [0.53ms]
(pass) JwtStrategy - BUG DETECTION > BUG-009: Email Verification Enforcement > should include emailVerified in query select [0.36ms]

src/auth/strategies/local.strategy.spec.ts:
(pass) LocalStrategy > validate > should return user when credentials are valid [0.93ms]
(pass) LocalStrategy > validate > should throw UnauthorizedException when credentials are invalid [1.61ms]
(pass) LocalStrategy > validate > should throw UnauthorizedException when user does not exist [0.46ms]
(pass) LocalStrategy > validate > should pass email and password to authService.validateUser [0.28ms]

src/auth/services/token-revocation.spec.ts:
89 |      * Current State: None of these exist!
90 |      */
91 | 
92 |     it('should have a method to revoke/blacklist a token', () => {
93 |       // BUG: This method doesn't exist!
94 |       expect(typeof (tokenService as any).revokeToken).toBe('function');
                                                            ^
error: expect(received).toBe(expected)

Expected: "function"
Received: "undefined"

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/token-revocation.spec.ts:94:56)
(fail) Token Revocation - BUG DETECTION > BUG-023: Token Revocation > should have a method to revoke/blacklist a token [1.20ms]
94 |       expect(typeof (tokenService as any).revokeToken).toBe('function');
95 |     });
96 | 
97 |     it('should have a method to logout all sessions', () => {
98 |       // BUG: This method doesn't exist!
99 |       expect(typeof (tokenService as any).revokeAllUserTokens).toBe('function');
                                                                    ^
error: expect(received).toBe(expected)

Expected: "function"
Received: "undefined"

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/token-revocation.spec.ts:99:64)
(fail) Token Revocation - BUG DETECTION > BUG-023: Token Revocation > should have a method to logout all sessions [0.45ms]
113 |         email: 'test@example.com',
114 |       });
115 | 
116 |       // BUG: Currently verifyToken only checks JWT signature,
117 |       // not if token is blacklisted!
118 |       expect(() => tokenService.verifyToken(revokedToken)).toThrow(
                                                                 ^
error: expect(received).toThrow(expected)

Expected constructor: UnauthorizedException

Received function did not throw
Received value: {
  sub: "user-123",
  email: "test@example.com",
}

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/token-revocation.spec.ts:118:60)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/token-revocation.spec.ts:102:58)
(fail) Token Revocation - BUG DETECTION > BUG-023: Token Revocation > should check token blacklist during validation [0.49ms]
(pass) Token Revocation - BUG DETECTION > BUG-023: Token Revocation > should track active sessions for logout all functionality [0.30ms]
(pass) Token Revocation - BUG DETECTION > BUG-023: Token Revocation > revoked token should be rejected on refresh [0.46ms]
(pass) Token Revocation - BUG DETECTION > Session Management > should store session when logging in [0.26ms]
(pass) Token Revocation - BUG DETECTION > Session Management > should enforce session limit of 5 [0.22ms]

src/auth/services/account-management.service.spec.ts:
58 |       }
59 |       throw error;
60 |     }
61 | 
62 |     // BUG-057 FIX: Revoke all existing tokens after email change
63 |     await this.tokenBlacklist.revokeAllUserTokens(userId);
                                   ^
TypeError: this.tokenBlacklist.revokeAllUserTokens is not a function. (In 'this.tokenBlacklist.revokeAllUserTokens(userId)', 'this.tokenBlacklist.revokeAllUserTokens' is undefined)
      at changeEmail (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.ts:63:31)
      at async <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.spec.ts:89:36)
(fail) AccountManagementService > changeEmail > should change email successfully when all validations pass [1.40ms]
(pass) AccountManagementService > changeEmail > should throw UnauthorizedException when user has no password [0.55ms]
(pass) AccountManagementService > changeEmail > should throw UnauthorizedException when password is incorrect [2.36ms]
172 |       passwordService.compare.mockResolvedValue(true);
173 |       mockFindUnique.mockResolvedValueOnce({
174 |         id: 'other-user',
175 |       } as any);
176 | 
177 |       await expect(async () => await service.changeEmail(userId, dto)).toThrow(
                                                                             ^
error: expect(received).toThrow(expected)

Expected message: "Email already in use"
Received message: "this.tokenBlacklist.revokeAllUserTokens is not a function. (In 'this.tokenBlacklist.revokeAllUserTokens(userId)', 'this.tokenBlacklist.revokeAllUserTokens' is undefined)"

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.spec.ts:177:72)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.spec.ts:156:74)
(fail) AccountManagementService > changeEmail > should throw ConflictException when new email is already taken [0.45ms]
58 |       }
59 |       throw error;
60 |     }
61 | 
62 |     // BUG-057 FIX: Revoke all existing tokens after email change
63 |     await this.tokenBlacklist.revokeAllUserTokens(userId);
                                   ^
TypeError: this.tokenBlacklist.revokeAllUserTokens is not a function. (In 'this.tokenBlacklist.revokeAllUserTokens(userId)', 'this.tokenBlacklist.revokeAllUserTokens' is undefined)
      at changeEmail (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.ts:63:31)
      at async <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.spec.ts:204:21)
(fail) AccountManagementService > changeEmail > should reset emailVerified to null when changing email [0.32ms]
78 |     await this.validatePassword(user, password);
79 |     await this.preventLastAdminDeletion(user.role);
80 | 
81 |     // BUG-055 FIX: Revoke all tokens BEFORE deleting account
82 |     // This ensures any existing tokens become invalid immediately
83 |     await this.tokenBlacklist.revokeAllUserTokens(userId);
                                   ^
TypeError: this.tokenBlacklist.revokeAllUserTokens is not a function. (In 'this.tokenBlacklist.revokeAllUserTokens(userId)', 'this.tokenBlacklist.revokeAllUserTokens' is undefined)
      at deleteAccount (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.ts:83:31)
      at async <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.spec.ts:233:36)
(fail) AccountManagementService > deleteAccount > should delete account successfully for non-admin user [0.42ms]
78 |     await this.validatePassword(user, password);
79 |     await this.preventLastAdminDeletion(user.role);
80 | 
81 |     // BUG-055 FIX: Revoke all tokens BEFORE deleting account
82 |     // This ensures any existing tokens become invalid immediately
83 |     await this.tokenBlacklist.revokeAllUserTokens(userId);
                                   ^
TypeError: this.tokenBlacklist.revokeAllUserTokens is not a function. (In 'this.tokenBlacklist.revokeAllUserTokens(userId)', 'this.tokenBlacklist.revokeAllUserTokens' is undefined)
      at deleteAccount (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.ts:83:31)
      at async <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.spec.ts:269:36)
(fail) AccountManagementService > deleteAccount > should delete admin account when there are multiple admins [0.36ms]
(pass) AccountManagementService > deleteAccount > should throw BadRequestException when deleting last admin [0.36ms]
(pass) AccountManagementService > deleteAccount > should throw UnauthorizedException when user has no password [0.32ms]
(pass) AccountManagementService > deleteAccount > should throw UnauthorizedException when password is incorrect [0.30ms]
78 |     await this.validatePassword(user, password);
79 |     await this.preventLastAdminDeletion(user.role);
80 | 
81 |     // BUG-055 FIX: Revoke all tokens BEFORE deleting account
82 |     // This ensures any existing tokens become invalid immediately
83 |     await this.tokenBlacklist.revokeAllUserTokens(userId);
                                   ^
TypeError: this.tokenBlacklist.revokeAllUserTokens is not a function. (In 'this.tokenBlacklist.revokeAllUserTokens(userId)', 'this.tokenBlacklist.revokeAllUserTokens' is undefined)
      at deleteAccount (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.ts:83:31)
      at async <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.spec.ts:358:21)
(fail) AccountManagementService > deleteAccount > should not check admin count for non-admin users [0.29ms]
(pass) AccountManagementService > error handling > should handle user not found in changeEmail [0.27ms]
(pass) AccountManagementService > error handling > should handle user not found in deleteAccount [0.30ms]

src/auth/services/token-refresh.service.spec.ts:
(pass) TokenRefreshService > refreshToken > should generate new tokens for valid user [0.86ms]
(pass) TokenRefreshService > refreshToken > should throw UnauthorizedException when user not found [1.77ms]
(pass) TokenRefreshService > refreshToken > should throw UnauthorizedException when user email is null [0.56ms]
(pass) TokenRefreshService > refreshToken > should generate tokens with correct payload [0.31ms]
53 | 
54 |       const user = await this.findUserById(decoded.sub);
55 |       return this.generateTokensForUser(user);
56 |     } catch {
57 |       this.logger.warn(`Invalid refresh token`, this.context);
58 |       throw new UnauthorizedException(ERROR_MESSAGES.UNAUTHORIZED);
                 ^
UnauthorizedException: Unauthorized access
 response: {
  message: "Unauthorized access",
  error: "Unauthorized",
  statusCode: 401,
},
   status: 401,
  options: {},

      at refreshWithToken (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/token-refresh.service.ts:58:13)
      at refreshWithToken (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/token-refresh.service.ts:38:26)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/token-refresh.service.spec.ts:172:36)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/token-refresh.service.spec.ts:147:59)
(fail) TokenRefreshService > refreshWithToken > should refresh tokens using valid refresh token [0.41ms]
(pass) TokenRefreshService > refreshWithToken > should throw UnauthorizedException for invalid refresh token [0.32ms]
(pass) TokenRefreshService > refreshWithToken > should throw UnauthorizedException when decoded user not found [0.28ms]
(pass) TokenRefreshService > refreshWithToken > should handle token verification errors gracefully [0.28ms]
(pass) TokenRefreshService > getCurrentUser > should return current user data [0.35ms]
(pass) TokenRefreshService > getCurrentUser > should throw UnauthorizedException when user not found [0.28ms]
(pass) TokenRefreshService > getCurrentUser > should return user with null fields correctly [0.24ms]
(pass) TokenRefreshService > getCurrentUser > should return admin user data correctly [0.26ms]

src/auth/services/account-management.service.bug.spec.ts:
91 |         newEmail: 'new@example.com',
92 |         currentPassword: 'password',
93 |       });
94 | 
95 |       // BUG: Should use transaction!
96 |       expect(mockPrisma.$transaction).toHaveBeenCalled();
                                           ^
error: expect(received).toHaveBeenCalled()

Expected number of calls: >= 1
Received number of calls: 0

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.bug.spec.ts:96:39)
(fail) AccountManagementService - BUG DETECTION > BUG-033: Email Change Race Condition (TOCTOU) > should use transaction to prevent race condition [0.73ms]
111 |       await expect(
112 |         service.changeEmail('user-123', {
113 |           newEmail: 'new@example.com',
114 |           currentPassword: 'password',
115 |         }),
116 |       ).rejects.toThrow(ConflictException);
                      ^
error: expect(received).toThrow(expected)

Expected constructor: ConflictException
Received constructor: Object

Received value: {
  code: "P2002",
  meta: {
    target: [ "email" ],
  },
}

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.bug.spec.ts:116:17)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.bug.spec.ts:99:69)
(fail) AccountManagementService - BUG DETECTION > BUG-033: Email Change Race Condition (TOCTOU) > should handle unique constraint violation on email change [1.62ms]
130 |       mockPrisma.user.delete.mockResolvedValue(mockUser);
131 | 
132 |       await service.deleteAccount('user-123', { password: 'password' });
133 | 
134 |       // BUG: Sessions/tokens should be invalidated!
135 |       expect(mockPrisma.session.deleteMany).toHaveBeenCalledWith({
                                                  ^
error: expect(received).toHaveBeenCalledWith(...expected)

Expected: [
  {
    where: {
      userId: "user-123",
    },
  }
]
But it was not called.
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.bug.spec.ts:135:45)
(fail) AccountManagementService - BUG DETECTION > BUG-055: Account Deletion Token Revocation > should revoke all tokens when account is deleted [0.48ms]
(pass) AccountManagementService - BUG DETECTION > BUG-055: Account Deletion Token Revocation > should add current token to blacklist on deletion [0.26ms]
168 |         newEmail: 'new@example.com',
169 |         currentPassword: 'password',
170 |       });
171 | 
172 |       // BUG: Sessions should be invalidated after email change!
173 |       expect(mockPrisma.session.deleteMany).toHaveBeenCalledWith({
                                                  ^
error: expect(received).toHaveBeenCalledWith(...expected)

Expected: [
  {
    where: {
      userId: "user-123",
    },
  }
]
But it was not called.
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/account-management.service.bug.spec.ts:173:45)
(fail) AccountManagementService - BUG DETECTION > BUG-057: Email Change Session Invalidation > should invalidate all sessions when email changes [0.28ms]

src/auth/services/auth-core.service.spec.ts:
(pass) AuthCoreService > signup > should create new user and return auth response [1.00ms]
(pass) AuthCoreService > signup > should use email prefix as name when name not provided [0.36ms]
(pass) AuthCoreService > signup > should throw ConflictException when email already exists [2.34ms]
(pass) AuthCoreService > signup > should throw when user email is null after creation [0.83ms]
(pass) AuthCoreService > signup > should log successful signup [0.57ms]
(pass) AuthCoreService > validateUser > should return user without password when credentials valid [0.48ms]
(pass) AuthCoreService > validateUser > should return null when user not found [0.29ms]
(pass) AuthCoreService > validateUser > should return null when user has no password [0.27ms]
(pass) AuthCoreService > validateUser > should return null when password invalid [0.27ms]
(pass) AuthCoreService > login > should return auth response when credentials valid [0.36ms]
(pass) AuthCoreService > login > should throw UnauthorizedException when user not found [0.36ms]
(pass) AuthCoreService > login > should throw UnauthorizedException when password invalid [0.31ms]
(pass) AuthCoreService > login > should throw when validated user has null email [0.30ms]
(pass) AuthCoreService > login > should log successful login [0.27ms]
(pass) AuthCoreService > login > should generate correct token payload [0.24ms]
(pass) AuthCoreService > login > should include all user fields in response [0.26ms]

src/auth/services/email-verification.service.spec.ts:
(pass) EmailVerificationService > requestVerification > should create token and send email when user exists and is not verified [0.93ms]
(pass) EmailVerificationService > requestVerification > should return success without sending email when user does not exist [0.38ms]
(pass) EmailVerificationService > requestVerification > should return success when email is already verified [0.28ms]
135 |       emailService.sendVerificationEmail.mockRejectedValue(
136 |         new Error('SMTP error'),
137 |       );
138 | 
139 |       // Should not throw despite email failure
140 |       await expect(service.requestVerification(dto)).resolves.not.toThrow();
                                                                        ^
error: expect(received).not.toThrow()

Thrown value: {
  success: true,
  message: "Verification email sent",
  token: "verification-token-123",
}

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/email-verification.service.spec.ts:140:67)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/email-verification.service.spec.ts:122:55)
(fail) EmailVerificationService > requestVerification > should handle email send failure gracefully [1.65ms]
(pass) EmailVerificationService > requestVerification > should include token in non-production mode [0.68ms]
(pass) EmailVerificationService > requestVerification > should use default name when user name is null [0.34ms]
(pass) EmailVerificationService > verifyEmail > should verify email and send welcome email successfully [0.50ms]
(pass) EmailVerificationService > verifyEmail > should handle welcome email send failure gracefully [0.38ms]
(pass) EmailVerificationService > verifyEmail > should handle missing user during welcome email gracefully [0.31ms]
(pass) EmailVerificationService > verifyEmail > should use default name for welcome email when user name is null [0.27ms]

src/auth/services/session.service.spec.ts:
(pass) TokenService > Token Generation > should generate token with correct payload [0.54ms]
(pass) TokenService > Token Generation > should throw error if email is missing [0.28ms]
(pass) TokenService > Token Verification > should verify valid token [0.23ms]
(pass) TokenService > Token Verification > should throw on invalid token [0.21ms]
(pass) TokenService > Token Decode > should decode token without verification [0.22ms]
(pass) Session Management (Business Rules) > should allow creating session when under limit [0.11ms]
(pass) Session Management (Business Rules) > should remove oldest session when at limit [0.09ms]
(pass) Session Management (Business Rules) > should maintain exactly 5 sessions after cleanup [0.08ms]
(pass) Rate Limiting (Login) > should allow login after 4 failed attempts [0.10ms]
(pass) Rate Limiting (Login) > should block IP after 5 failed attempts [0.02ms]
(pass) Rate Limiting (Login) > should NOT block different IP for same email (IP-based, not email-based) [0.02ms]
(pass) Rate Limiting (Login) > should clear attempts on successful login [0.03ms]
(pass) Rate Limiting (Login) > should track attempt count correctly [0.02ms]

src/auth/services/verification-token.service.spec.ts:
(pass) VerificationTokenService > createEmailVerificationToken > should create email verification token [1.72ms]
(pass) VerificationTokenService > createEmailVerificationToken > should set expiry time correctly for email verification [0.96ms]
(pass) VerificationTokenService > createEmailVerificationToken > should upsert token to handle existing tokens [0.78ms]
(pass) VerificationTokenService > createPasswordResetToken > should create password reset token with prefix [1.03ms]
(pass) VerificationTokenService > createPasswordResetToken > should set shorter expiry for password reset tokens [0.82ms]
(pass) VerificationTokenService > validateEmailVerificationToken > should validate and delete valid email verification token [1.01ms]
(pass) VerificationTokenService > validateEmailVerificationToken > should throw BadRequestException for non-existent token [2.35ms]
(pass) VerificationTokenService > validateEmailVerificationToken > should throw BadRequestException for expired token [0.82ms]
(pass) VerificationTokenService > validateEmailVerificationToken > should handle cleanup failure for expired tokens gracefully [0.57ms]
(pass) VerificationTokenService > validatePasswordResetToken > should validate and return email from reset token [0.56ms]
(pass) VerificationTokenService > validatePasswordResetToken > should throw BadRequestException for email verification token [0.52ms]
(pass) VerificationTokenService > validatePasswordResetToken > should throw BadRequestException for null token [0.49ms]
(pass) VerificationTokenService > validatePasswordResetToken > should throw BadRequestException for expired reset token [0.53ms]
(pass) VerificationTokenService > validatePasswordResetToken > should extract email correctly from prefixed identifier [0.43ms]
(pass) VerificationTokenService > token generation > should generate different tokens on subsequent calls [0.40ms]
(pass) VerificationTokenService > token generation > should generate hex string tokens [0.41ms]

src/auth/services/password-change.bug.spec.ts:
49 |         password: 'newHashedPassword',
50 |       });
51 | 
52 |       // After password change, sessions should be cleared
53 |       // BUG: This is NOT being called!
54 |       expect(mockPrisma.session.deleteMany).toHaveBeenCalledWith({
                                                 ^
error: expect(received).toHaveBeenCalledWith(...expected)

Expected: [
  {
    where: {
      userId: "user-123",
    },
  }
]
But it was not called.
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/password-change.bug.spec.ts:54:45)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/password-change.bug.spec.ts:43:64)
(fail) Password Change - BUG DETECTION > BUG-056: Sessions Not Invalidated After Password Change > should invalidate all sessions when password changes [0.29ms]
(pass) Password Change - BUG DETECTION > BUG-056: Sessions Not Invalidated After Password Change > should blacklist all active tokens when password changes [0.07ms]

src/auth/services/password.service.spec.ts:
(pass) PasswordService > hash > should hash a password [81.25ms]
(pass) PasswordService > hash > should generate different hashes for the same password [135.51ms]
(pass) PasswordService > compare > should return true for matching password and hash [137.33ms]
(pass) PasswordService > compare > should return false for non-matching password [134.97ms]

src/auth/services/password-reset.service.spec.ts:
(pass) PasswordResetService > forgotPassword > should create token and send email when user exists [1.11ms]
(pass) PasswordResetService > forgotPassword > should return success without sending email when user does not exist [0.38ms]
(pass) PasswordResetService > forgotPassword > should handle email send failure gracefully [0.41ms]
(pass) PasswordResetService > forgotPassword > should include token in non-production mode when email sent [0.29ms]
(pass) PasswordResetService > forgotPassword > should include token in non-production mode when email fails [0.33ms]
(pass) PasswordResetService > resetPassword > should reset password successfully with valid token [0.35ms]
(pass) PasswordResetService > resetPassword > should throw error when token is invalid [0.31ms]
120 | 
121 |     await this.updatePasswordById(userId, hashedPassword);
122 | 
123 |     // BUG-056 FIX: Revoke all existing tokens after password change
124 |     // This ensures old sessions with the compromised password are invalidated
125 |     await this.tokenBlacklist.revokeAllUserTokens(userId);
                                    ^
TypeError: this.tokenBlacklist.revokeAllUserTokens is not a function. (In 'this.tokenBlacklist.revokeAllUserTokens(userId)', 'this.tokenBlacklist.revokeAllUserTokens' is undefined)
      at changePassword (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/password-reset.service.ts:125:31)
      at async <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/auth/services/password-reset.service.spec.ts:243:36)
(fail) PasswordResetService > changePassword > should change password successfully when current password is correct [3.35ms]
(pass) PasswordResetService > changePassword > should throw NotFoundException when user does not exist [0.73ms]
(pass) PasswordResetService > changePassword > should throw NotFoundException when user has no password [0.61ms]
(pass) PasswordResetService > changePassword > should throw UnauthorizedException when current password is incorrect [0.66ms]

src/auth/services/token.service.spec.ts:
(pass) TokenService > generateToken > should generate a JWT token with correct payload [1.22ms]
(pass) TokenService > generateToken > should include hasCompletedOnboarding false when user has not completed [0.58ms]
(pass) TokenService > verifyToken > should verify and return decoded token [0.36ms]
(pass) TokenService > verifyToken > should throw when token is invalid [0.35ms]
(pass) TokenService > decodeToken > should decode token without verification [0.29ms]
(pass) TokenService > decodeToken > should return null for invalid token [0.27ms]

src/dsl/migrators/dsl-migration.service.spec.ts:
(pass) DslMigrationService > registerMigrators > should register migrators [0.82ms]
(pass) DslMigrationService > migrate > should return same DSL if already at target version [0.42ms]
(pass) DslMigrationService > migrate > should migrate to next version [0.29ms]
(pass) DslMigrationService > migrate > should throw if no migrator found [0.24ms]
(pass) DslMigrationService > migrate > should apply migration chain [0.19ms]
(pass) DslMigrationService > migrate > should detect circular migration [0.21ms]
(pass) DslMigrationService > migrate > should throw if migration result has wrong version [0.24ms]
(pass) DslMigrationService > canMigrate > should return true for same version [0.17ms]
(pass) DslMigrationService > canMigrate > should return true if migration path exists [0.18ms]
(pass) DslMigrationService > canMigrate > should return false if no migration path exists [0.17ms]
(pass) DslMigrationService > getMigrationPath > should return single version for same version [0.23ms]
(pass) DslMigrationService > getMigrationPath > should return migration path [0.16ms]
(pass) DslMigrationService > getMigrationPath > should throw if no path exists [0.16ms]

src/integrations/github/github.service.spec.ts:
(pass) GitHubService > should be defined [0.52ms]
(pass) GitHubService > getUserProfile > should delegate to GitHubApiService [0.31ms]
(pass) GitHubService > getUserProfile > should propagate errors from GitHubApiService [0.35ms]
(pass) GitHubService > syncUserGitHub > should delegate to syncService [0.30ms]

src/translation/services/translation-core.service.spec.ts:
(pass) TranslationCoreService > Fallback Behavior > should return original text when service is unavailable [0.90ms]
[31m[Nest] 348886  - [39m01/07/2026, 7:23:25 PM [31m  ERROR[39m [38;5;3m[TranslationCoreService] [39m[31mTranslation failed: Connection refused[39m
(pass) TranslationCoreService > Fallback Behavior > should return original text on HTTP error [1.49ms]
[31m[Nest] 348886  - [39m01/07/2026, 7:23:25 PM [31m  ERROR[39m [38;5;3m[TranslationCoreService] [39m[31mTranslation failed: Timeout[39m
(pass) TranslationCoreService > Fallback Behavior > should return original text on timeout [0.46ms]
[31m[Nest] 348886  - [39m01/07/2026, 7:23:25 PM [31m  ERROR[39m [38;5;3m[TranslationCoreService] [39m[31mTranslation failed: Service error[39m
(pass) TranslationCoreService > Fallback Behavior > should continue main flow on translation failure [0.39ms]
(pass) TranslationCoreService > Successful Translation > should translate PT to EN [0.50ms]
(pass) TranslationCoreService > Successful Translation > should translate EN to PT [0.28ms]
(pass) TranslationCoreService > Supported Languages (PT-BR and EN only) > should support pt as source language [0.28ms]
(pass) TranslationCoreService > Supported Languages (PT-BR and EN only) > should support en as source language [0.26ms]
(pass) TranslationCoreService > Empty/Null Text Handling > should return empty string for empty input [0.21ms]
(pass) TranslationCoreService > Empty/Null Text Handling > should return whitespace string as-is [0.20ms]
(pass) TranslationCoreService > Service Availability > should check service health on init [0.27ms]
(pass) TranslationCoreService > Service Availability > should mark service unavailable on health check failure [0.28ms]
(pass) TranslationCoreService > Service Availability > should report availability status [0.18ms]

src/common/cache/services/cache-core.service.spec.ts:
(pass) CacheCoreService > get > should return parsed value on success [0.80ms]
(pass) CacheCoreService > get > should return null on cache miss [0.29ms]
(pass) CacheCoreService > get > should return null and log error on Redis failure [0.34ms]
(pass) CacheCoreService > get > should return null when cache is disabled [0.29ms]
(pass) CacheCoreService > get > should return null when client is null [0.21ms]
(pass) CacheCoreService > set > should set value without TTL [0.29ms]
(pass) CacheCoreService > set > should set value with TTL [0.21ms]
(pass) CacheCoreService > set > should log error on Redis failure [0.24ms]
(pass) CacheCoreService > set > should do nothing when cache is disabled [0.20ms]
(pass) CacheCoreService > delete > should delete key [0.26ms]
(pass) CacheCoreService > delete > should log error on Redis failure [0.25ms]
(pass) CacheCoreService > delete > should do nothing when cache is disabled [0.20ms]
(pass) CacheCoreService > deletePattern > should delete all matching keys [0.28ms]
(pass) CacheCoreService > deletePattern > should not call del when no keys match [0.19ms]
(pass) CacheCoreService > deletePattern > should log error on Redis failure [0.22ms]
(pass) CacheCoreService > deletePattern > should do nothing when cache is disabled [0.18ms]
(pass) CacheCoreService > flush > should flush database and log success [0.26ms]
(pass) CacheCoreService > flush > should log error on Redis failure [0.24ms]
(pass) CacheCoreService > flush > should do nothing when cache is disabled [0.20ms]
(pass) CacheCoreService > isEnabled > should return true when Redis is enabled and client exists [0.15ms]
(pass) CacheCoreService > isEnabled > should return false when Redis is disabled [0.18ms]
(pass) CacheCoreService > isEnabled > should return false when client is null [0.16ms]

src/resumes/services/base/base-sub-resource.service.spec.ts:
92 |       mockResumesRepository.findOne.mockResolvedValue(mockResume as any);
93 | 
94 |       // Access private method through public methods
95 |       await expect(
96 |         service.listForResume(mockResumeId, mockUserId),
97 |       ).resolves.not.toThrow();
                          ^
error: expect(received).not.toThrow()

Thrown value: undefined

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/resumes/services/base/base-sub-resource.service.spec.ts:97:22)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/resumes/services/base/base-sub-resource.service.spec.ts:91:60)
(fail) BaseSubResourceService > validateResumeOwnership > should pass validation when user owns the resume [2.43ms]
(pass) BaseSubResourceService > validateResumeOwnership > should throw ForbiddenException when resume not found [0.62ms]
(pass) BaseSubResourceService > validateResumeOwnership > should throw ForbiddenException when user does not own resume [0.28ms]
(pass) BaseSubResourceService > listForResume > should return paginated results for valid owner [0.25ms]
(pass) BaseSubResourceService > listForResume > should pass custom pagination parameters [0.22ms]
(pass) BaseSubResourceService > listForResume > should use default pagination when not provided [0.24ms]
(pass) BaseSubResourceService > findOne > should return entity when found [0.22ms]
(pass) BaseSubResourceService > findOne > should throw NotFoundException when entity not found [0.24ms]
(pass) BaseSubResourceService > findOne > should validate resume ownership before finding entity [0.21ms]
(pass) BaseSubResourceService > create > should create entity for valid owner [0.21ms]
(pass) BaseSubResourceService > create > should validate resume ownership before creating [0.21ms]
(pass) BaseSubResourceService > update > should update entity for valid owner [0.21ms]
(pass) BaseSubResourceService > update > should throw NotFoundException when entity not found [0.18ms]
(pass) BaseSubResourceService > update > should validate resume ownership before updating [0.22ms]
(pass) BaseSubResourceService > remove > should delete entity for valid owner [0.20ms]
(pass) BaseSubResourceService > remove > should throw NotFoundException when entity not found [0.20ms]
(pass) BaseSubResourceService > remove > should validate resume ownership before deleting [0.20ms]
(pass) BaseSubResourceService > reorder > should reorder entities for valid owner [0.27ms]
(pass) BaseSubResourceService > reorder > should validate resume ownership before reordering [0.23ms]

src/integrations/github/services/github-sync.service.limit.spec.ts:
54 |     mockAchievementService = {
55 |       generateAchievements: mock().mockReturnValue([]),
56 |     };
57 | 
58 |     mockDatabaseService = {
59 |       verifyResumeOwnership: jest
                                  ^
ReferenceError: jest is not defined
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:59:30)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:44:14)
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should REJECT sync when daily limit reached [0.26ms]
54 |     mockAchievementService = {
55 |       generateAchievements: mock().mockReturnValue([]),
56 |     };
57 | 
58 |     mockDatabaseService = {
59 |       verifyResumeOwnership: jest
                                  ^
ReferenceError: jest is not defined
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:59:30)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:44:14)
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should ALLOW sync when under daily limit [0.02ms]
54 |     mockAchievementService = {
55 |       generateAchievements: mock().mockReturnValue([]),
56 |     };
57 | 
58 |     mockDatabaseService = {
59 |       verifyResumeOwnership: jest
                                  ^
ReferenceError: jest is not defined
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:59:30)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:44:14)
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should check sync count before processing [0.02ms]
54 |     mockAchievementService = {
55 |       generateAchievements: mock().mockReturnValue([]),
56 |     };
57 | 
58 |     mockDatabaseService = {
59 |       verifyResumeOwnership: jest
                                  ^
ReferenceError: jest is not defined
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:59:30)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:44:14)
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should record sync after successful completion [0.01ms]
54 |     mockAchievementService = {
55 |       generateAchievements: mock().mockReturnValue([]),
56 |     };
57 | 
58 |     mockDatabaseService = {
59 |       verifyResumeOwnership: jest
                                  ^
ReferenceError: jest is not defined
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:59:30)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:44:14)
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should return remaining syncs in response [0.01ms]
54 |     mockAchievementService = {
55 |       generateAchievements: mock().mockReturnValue([]),
56 |     };
57 | 
58 |     mockDatabaseService = {
59 |       verifyResumeOwnership: jest
                                  ^
ReferenceError: jest is not defined
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:59:30)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:44:14)
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-018: GitHub Account Uniqueness > should REJECT sync if GitHub account linked to another user [0.01ms]
54 |     mockAchievementService = {
55 |       generateAchievements: mock().mockReturnValue([]),
56 |     };
57 | 
58 |     mockDatabaseService = {
59 |       verifyResumeOwnership: jest
                                  ^
ReferenceError: jest is not defined
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:59:30)
      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-sync.service.limit.spec.ts:44:14)
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-018: GitHub Account Uniqueness > should check GitHub account uniqueness before sync

src/integrations/github/services/github-api.service.spec.ts:
(pass) GitHubApiService > fetchGitHub > should fetch data successfully with authorization header [1.01ms]
(pass) GitHubApiService > fetchGitHub > should work without token [0.73ms]
(pass) GitHubApiService > Error Handling > should throw NOT_FOUND for 404 response [1.66ms]
(pass) GitHubApiService > Error Handling > should throw FORBIDDEN for 403 (rate limit) response [0.48ms]
(pass) GitHubApiService > Error Handling > should throw BAD_GATEWAY for other errors [0.28ms]
(pass) GitHubApiService > getUserProfile > should return user profile [0.26ms]
(pass) GitHubApiService > getUserRepos > should return user repos with default options [0.30ms]
(pass) GitHubApiService > getUserRepos > should accept custom options [0.25ms]
(pass) GitHubApiService > getRepoCommitCount > should return commit count [0.30ms]
(pass) GitHubApiService > getRepoCommitCount > should return 0 on error (graceful degradation) [0.25ms]
(pass) GitHubApiService > getRepoCommitCount > should return 0 for non-array response [0.21ms]
(pass) GitHubApiService > getRepoPullRequests > should return PR count [0.28ms]
(pass) GitHubApiService > getRepoPullRequests > should return 0 on error (graceful degradation) [0.27ms]
(pass) GitHubApiService > getRepoIssues > should return issue count [0.38ms]
(pass) GitHubApiService > getRepoIssues > should return 0 on error (graceful degradation) [0.23ms]

src/integrations/github/services/github-api.service.bug.spec.ts:
35 |      * Fails with various URL formats.
36 |      */
37 |     it('should extract username from standard URL', () => {
38 |       const url = 'https://github.com/octocat';
39 |       const username = (service as any).extractUsername?.(url);
40 |       expect(username).toBe('octocat');
                            ^
error: expect(received).toBe(expected)

Expected: "octocat"
Received: undefined

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-api.service.bug.spec.ts:40:24)
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should extract username from standard URL [0.71ms]
42 | 
43 |     it('should handle URL with trailing slash', () => {
44 |       const url = 'https://github.com/octocat/';
45 |       const username = (service as any).extractUsername?.(url);
46 |       // BUG: Might return empty string!
47 |       expect(username).toBe('octocat');
                            ^
error: expect(received).toBe(expected)

Expected: "octocat"
Received: undefined

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-api.service.bug.spec.ts:47:24)
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle URL with trailing slash [0.33ms]
49 | 
50 |     it('should handle URL with query string', () => {
51 |       const url = 'https://github.com/octocat?tab=repositories';
52 |       const username = (service as any).extractUsername?.(url);
53 |       // BUG: Might include query string!
54 |       expect(username).toBe('octocat');
                            ^
error: expect(received).toBe(expected)

Expected: "octocat"
Received: undefined

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-api.service.bug.spec.ts:54:24)
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle URL with query string [0.22ms]
56 | 
57 |     it('should handle URL with fragment', () => {
58 |       const url = 'https://github.com/octocat#readme';
59 |       const username = (service as any).extractUsername?.(url);
60 |       // BUG: Might include fragment!
61 |       expect(username).toBe('octocat');
                            ^
error: expect(received).toBe(expected)

Expected: "octocat"
Received: undefined

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-api.service.bug.spec.ts:61:24)
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle URL with fragment [0.20ms]
63 | 
64 |     it('should handle URL with repo path', () => {
65 |       const url = 'https://github.com/octocat/my-repo';
66 |       const username = (service as any).extractUsername?.(url);
67 |       // Should extract only username, not repo
68 |       expect(username).toBe('octocat');
                            ^
error: expect(received).toBe(expected)

Expected: "octocat"
Received: undefined

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-api.service.bug.spec.ts:68:24)
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle URL with repo path [0.21ms]
70 | 
71 |     it('should handle www subdomain', () => {
72 |       const url = 'https://www.github.com/octocat';
73 |       const username = (service as any).extractUsername?.(url);
74 |       // BUG: Might fail with www!
75 |       expect(username).toBe('octocat');
                            ^
error: expect(received).toBe(expected)

Expected: "octocat"
Received: undefined

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-api.service.bug.spec.ts:75:24)
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle www subdomain [0.21ms]
77 | 
78 |     it('should reject non-GitHub URLs', () => {
79 |       const url = 'https://gitlab.com/octocat';
80 |       const username = (service as any).extractUsername?.(url);
81 |       // BUG: Might accept any URL!
82 |       expect(username).toBeNull();
                            ^
error: expect(received).toBeNull()

Received: undefined

      at <anonymous> (/home/ilelo/Documents/Projects/profile/profile-services/src/integrations/github/services/github-api.service.bug.spec.ts:82:24)
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should reject non-GitHub URLs [0.19ms]
(pass) GitHubApiService - BUG DETECTION > BUG-048: Token Exposed in Logs > should redact token in error logs [0.16ms]
(pass) GitHubApiService - BUG DETECTION > BUG-048: Token Exposed in Logs > should not include token in request retry logs [0.15ms]

47 tests failed:
(fail) ThemeQueryService - BUG DETECTION > BUG-051: No Pagination Limit > should enforce maximum limit on search [1.00ms]
(fail) ThemeQueryService - BUG DETECTION > BUG-051: No Pagination Limit > should have default limit when none provided [0.46ms]
(fail) OnboardingProgressService - Bug Detection > Sequential step validation > should REJECT skipping from welcome to skills [0.32ms]
(fail) OnboardingProgressService - Bug Detection > Sequential step validation > should REJECT going to education without completing experience step [1.86ms]
(fail) TechSkillsQueryService (Facade) > searchAll > should return combined results of languages and skills [0.40ms]
(fail) TechNicheQueryService > getAllNiches > should cache results [0.41ms]
(fail) LanguageQueryService > getAllLanguages > should cache results [0.44ms]
(fail) TechAreaQueryService > getAllAreas > should return cached results on second call [0.36ms]
(fail) TechAreaQueryService > getAllAreas > should return results sorted by order [0.27ms]
(fail) SkillQueryService > getAllSkills > should cache results [1.63ms]
(fail) JwtStrategy > validate > should return user payload when user exists [2.28ms]
(fail) JwtStrategy > validate > should return correct onboarding status [0.76ms]
(fail) JwtStrategy > validate > should return admin role when user is admin [0.43ms]
(fail) JwtStrategy > constructor > should throw error when JWT_SECRET is not configured [1.39ms]
(fail) Token Revocation - BUG DETECTION > BUG-023: Token Revocation > should have a method to revoke/blacklist a token [1.20ms]
(fail) Token Revocation - BUG DETECTION > BUG-023: Token Revocation > should have a method to logout all sessions [0.45ms]
(fail) Token Revocation - BUG DETECTION > BUG-023: Token Revocation > should check token blacklist during validation [0.49ms]
(fail) AccountManagementService > changeEmail > should change email successfully when all validations pass [1.40ms]
(fail) AccountManagementService > changeEmail > should throw ConflictException when new email is already taken [0.45ms]
(fail) AccountManagementService > changeEmail > should reset emailVerified to null when changing email [0.32ms]
(fail) AccountManagementService > deleteAccount > should delete account successfully for non-admin user [0.42ms]
(fail) AccountManagementService > deleteAccount > should delete admin account when there are multiple admins [0.36ms]
(fail) AccountManagementService > deleteAccount > should not check admin count for non-admin users [0.29ms]
(fail) TokenRefreshService > refreshWithToken > should refresh tokens using valid refresh token [0.41ms]
(fail) AccountManagementService - BUG DETECTION > BUG-033: Email Change Race Condition (TOCTOU) > should use transaction to prevent race condition [0.73ms]
(fail) AccountManagementService - BUG DETECTION > BUG-033: Email Change Race Condition (TOCTOU) > should handle unique constraint violation on email change [1.62ms]
(fail) AccountManagementService - BUG DETECTION > BUG-055: Account Deletion Token Revocation > should revoke all tokens when account is deleted [0.48ms]
(fail) AccountManagementService - BUG DETECTION > BUG-057: Email Change Session Invalidation > should invalidate all sessions when email changes [0.28ms]
(fail) EmailVerificationService > requestVerification > should handle email send failure gracefully [1.65ms]
(fail) Password Change - BUG DETECTION > BUG-056: Sessions Not Invalidated After Password Change > should invalidate all sessions when password changes [0.29ms]
(fail) PasswordResetService > changePassword > should change password successfully when current password is correct [3.35ms]
(fail) BaseSubResourceService > validateResumeOwnership > should pass validation when user owns the resume [2.43ms]
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should REJECT sync when daily limit reached [0.26ms]
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should ALLOW sync when under daily limit [0.02ms]
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should check sync count before processing [0.02ms]
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should record sync after successful completion [0.01ms]
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-008: Daily Sync Limit (10 per day) > should return remaining syncs in response [0.01ms]
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-018: GitHub Account Uniqueness > should REJECT sync if GitHub account linked to another user [0.01ms]
(fail) GitHubSyncService - RATE LIMIT BUG DETECTION > BUG-018: GitHub Account Uniqueness > should check GitHub account uniqueness before sync
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should extract username from standard URL [0.71ms]
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle URL with trailing slash [0.33ms]
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle URL with query string [0.22ms]
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle URL with fragment [0.20ms]
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle URL with repo path [0.21ms]
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should handle www subdomain [0.21ms]
(fail) GitHubApiService - BUG DETECTION > BUG-031: URL Extraction Not Robust > should reject non-GitHub URLs [0.19ms]

 954 pass
 47 fail
 1 error
 1519 expect() calls
Ran 1001 tests across 95 files. [2.57s]
